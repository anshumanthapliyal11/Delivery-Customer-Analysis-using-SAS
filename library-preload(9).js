sap.ui.require.preload({
	"sas/hc/ui/services/comment/library.js": "// (c) 2014, SAS Institute Inc.\nsap.ui.define([\"sap/ui/core/Core\",\"sap/ui/core/library\",\"sas/hc/ui/commons/library\",\"sas/hc/m/library\",\"sas/ltjs/commons/library\"],function(){\"use strict\";return sap.ui.getCore().initLibrary({name:\"sas.hc.ui.services.comment\",dependencies:[\"sap.ui.core\",\"sas.hc.ui.commons\",\"sas.hc.m\",\"sas.ltjs.commons\"],types:[],interfaces:[],controls:[\"sas.hc.ui.services.comment.CommentManager\",\"sas.hc.ui.services.comment.components.CommentEntryForm\",\"sas.hc.ui.services.comment.components.CommentListItem\",\"sas.hc.ui.services.comment.controller.CommentManagerController\",\"sas.hc.ui.services.comment.model.Attachment\",\"sas.hc.ui.services.comment.model.Comment\",\"sas.hc.ui.services.comment.model.CommentDataModel\",\"sas.hc.ui.services.comment.model.CommentNode\",\"sas.hc.ui.services.comment.model.TrackComment\",\"sas.hc.ui.services.comment.petrichor.CommentManager\",\"sas.hc.ui.services.comment.petrichor.components.CommentEntryForm\",\"sas.hc.ui.services.comment.petrichor.components.CommentListItem\",\"sas.hc.ui.services.comment.petrichor.components.CommentReplyForm\",\"sas.hc.ui.services.comment.petrichor.controller.CommentManagerController\",\"sas.hc.ui.services.comment.petrichor.model.Attachment\",\"sas.hc.ui.services.comment.petrichor.model.Comment\",\"sas.hc.ui.services.comment.petrichor.model.CommentsInfo\",\"sas.hc.ui.services.comment.petrichor.model.TrackComment\",\"sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator\",\"sas.hc.ui.services.comment.petrichor.proxy.AbstractServiceProxy\",\"sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy\",\"sas.hc.ui.services.comment.petrichor.util.AttachmentReader\",\"sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil\",\"sas.hc.ui.services.comment.proxy.AbstractServicesProxy\",\"sas.hc.ui.services.comment.proxy.ServicesProxy\",\"sas.hc.ui.services.comment.util.CommentManagerUtil\"],elements:[],version:\"10.1.21\"}),sas.hc.ui.services.comment});",
	"sas/hc/ui/services/comment/petrichor/CommentManager.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.CommentManager\"),jQuery.sap.require(\"sap.ui.core.Core\"),jQuery.sap.require(\"sas.hc.ui.core.Core\"),jQuery.sap.require(\"sap.ui.core.ResizeHandler\"),jQuery.sap.require(\"sap.ui.model.json.JSONModel\"),jQuery.sap.require(\"sap.ui.model.BindingMode\"),jQuery.sap.require(\"sap.ui.core.library\"),jQuery.sap.require(\"sap.ui.core.Control\"),jQuery.sap.require(\"sap.m.library\"),jQuery.sap.require(\"sap.ui.core.format.DateFormat\"),jQuery.sap.require(\"sap.ui.Device\"),jQuery.sap.require(\"jquery.sap.dom\"),jQuery.sap.require(\"sas.hc.ui.core.theme.IconInitialization\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.CommentManagerRenderer\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentListItem\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentEntryForm\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.controller.CommentManagerController\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.TrackComment\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.CommentsInfo\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.util.AttachmentReader\"),jQuery.sap.require(\"sas.hc.m.ScrollContainer\"),jQuery.sap.require(\"sas.hc.m.List\"),jQuery.sap.require(\"sas.hc.m.Panel\"),jQuery.sap.require(\"sas.hc.m.MessageDialog\"),jQuery.sap.require(\"sas.hc.m.SearchField\"),jQuery.sap.require(\"sas.hc.m.ZeroState\"),jQuery.sap.require(\"sas.hc.m.ResponsiveToolbar\"),jQuery.sap.require(\"sas.hc.ui.core.Control\"),jQuery.sap.require(\"sas.hc.ui.core.util.UserInfo\"),jQuery.sap.require(\"sas.ltjs.sasicu.util.SASFormatterUtil\"),jQuery.sap.require(\"sas.hc.ui.core.util.CalendarUtil\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentReplyForm\"),jQuery.sap.require(\"sas.hc.m.Label\"),jQuery.sap.require(\"sas.hc.m.library\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.Comment\"),jQuery.sap.require(\"sas.hc.m.MessageStrip\"),jQuery.sap.require(\"sas.hc.ui.core.settings.GlobalSettingsHelper\"),jQuery.sap.require(\"sas.hc.ui.core.GlobalSettings\"),jQuery.sap.require(\"sas.hc.ui.core.library\"),function(){\"use strict\";var e,t,s=sap.ui.requireSync(\"sap/ui/events/KeyCodes\"),i=sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil,o=sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator,r=[\".ade\",\".adp\",\".app\",\".asp\",\".bas\",\".bat\",\".cer\",\".chm\",\".cmd\",\".cnt\",\".com\",\".cpl\",\".crt\",\".csh\",\".der\",\".exe\",\".fxp\",\".gadget\",\".hlp\",\".hpj\",\".hta\",\".inf\",\".ins\",\".isp\",\".its\",\".js\",\".jse\",\".ksh\",\".lnk\",\".mad\",\".maf\",\".mag\",\".mam\",\".maq\",\".mar\",\".mas\",\".mat\",\".mau\",\".mav\",\".maw\",\".mda\",\".mdb\",\".mde\",\".mdt\",\".mdw\",\".mdz\",\".msc\",\".msh\",\".msh1\",\".msh2\",\".mshxml\",\".msh1xml\",\".msh2xml\",\".msi\",\".msp\",\".mst\",\".ops\",\".osd\",\".pcd\",\".pif\",\".plg\",\".prf\",\".prg\",\".pst\",\".reg\",\".scf\",\".scr\",\".sct\",\".shb\",\".shs\",\".ps1\",\".ps1xml\",\".ps2\",\".ps2xml\",\".psc1\",\".psc2\",\".tmp\",\".url\",\".vb\",\".vbe\",\".vbp\",\".vbs\",\".vsmacros\",\".vsw\",\".ws\",\".wsc\",\".wsf\",\".wsh\",\".xnk\"];sas.ltjs.sasicu.util.SASFormatterUtil.instancePromise(\"DATETIME15\").then(function(t){e=t}),sas.ltjs.sasicu.util.SASFormatterUtil.instancePromise(\"COMMA\").then(function(e){t=e}),sas.hc.ui.core.Control.extend(\"sas.hc.ui.services.comment.petrichor.CommentManager\",{metadata:{library:\"sas.hc.ui.services.comment\",properties:{associatedObject:{type:\"string\",group:\"Behavior\"},resourceUri:{type:\"string\",group:\"Behavior\"},elementId:{type:\"string\",group:\"Behavior\"},maxPreviewLines:{type:\"int\",group:\"Appearance\",defaultValue:5},showEdit:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},showDelete:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},showAttachment:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},readOnly:{type:\"boolean\",group:\"Misc\",defaultValue:!1},width:{type:\"sap.ui.core.CSSSize\",group:\"Appearance\",defaultValue:\"100%\"},height:{type:\"sap.ui.core.CSSSize\",group:\"Appearance\",defaultValue:\"auto\"},title:{type:\"string\",group:\"Data\",defaultValue:null},showTitle:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},maxReplyDisplay:{type:\"int\",group:\"Appearance\",defaultValue:5},commentListMode:{type:\"string\",group:\"Appearance\",defaultValue:sap.m.ListMode.None}},aggregations:{mainContainer:{type:\"sas.hc.m.Panel\",multiple:!1,visibility:\"hidden\"}},publicMethods:[\"update\",\"clear\",\"getServiceProxy\",\"setServiceProxy\",\"addRestrictedFileTypes\"],events:{commentCountUpdated:{},commentInteracted:{}}},rb:sap.ui.getCore().getLibraryResourceBundle(\"sas.hc.ui.services.comment\"),renderer:\"sas.hc.ui.services.comment.petrichor.CommentManagerRenderer\"}),sas.hc.ui.services.comment.petrichor.CommentManager.prototype.init=function(){sas.hc.ui.core.Control.prototype.init&&sas.hc.ui.core.Control.prototype.init.apply(this),this._addConfiguredRestrictedFileExtensions();var e;if(sas.hc.ui.core.util.UserInfo&&sas.hc.ui.core.util.UserInfo.instance)this._userInfo=sas.hc.ui.core.util.UserInfo.instance;else{var t={};t.state=\"active\",t.userid=\"sasadm\",t.id=\"sasadm\",t.name=\"SAS Administrator\",t.displayName=\"SAS Administrator\",t.description=\"<1685> {R2410} (DVT) [Cary;NC]\",t.addresses=[0],t.links=[0],t.version=1,t.providerId=\"7637b5a5-d94d-4a3d-8831-e740e667bd85\",t.creationTimeStamp=\"2001-03-22T22:08:07.000Z\",t.modifiedTimeStamp=\"2015-10-22T07:38:05.000Z\",this._userInfo=t}this._userCapability=jQuery.parseJSON('{\"WIP_COMMENT_EDIT\":false, \"WIP_COMMENT_DELETE\":false}'),this._count=0,this._MIN_PAGESIZE=10,this._MIN_COMMENT_HEIGHT=100,this._trackComment=new sas.hc.ui.services.comment.petrichor.model.TrackComment,this._displayMode=sas.hc.ui.services.comment.petrichor.CommentManager.NORMAL_MODE,this._updatePending=!1,this._clearPending=!1,this._newResourceUri=\"\",this._isSearchHighlighted=!1,this._hasWriteAccess=!0,this._isCommentEditMode=!1,this._searchFieldCleared=!1,this._editCapable=!1,this._deleteCapable=!1,e=new sas.hc.m.Panel(this.getId()+\"-mainContainer\",{landmarkLabel:this.rb.getText(\"CommentManager.panel.landmarkLabel.txt\"),ariaLabel:this.rb.getText(\"CommentManager.panel.ariaLabel.txt\"),focusable:!1,height:\"100%\",width:\"100%\"}),e.addStyleClass(\"sasCommentManager sasPetrichorCommentManager\"),e.setBusyIndicatorDelay(0),e.setBusy(!0),this.setAggregation(\"mainContainer\",e),this._searchField=new sas.hc.m.SearchField(this.getId()+\"-searchField\",{landmarkLabel:this.rb.getText(\"CommentManager.searchField.landmarkLabel.txt\"),ariaLabel:this.rb.getText(\"CommentManager.searchField.ariaLabel.txt\"),enableExpandCollapse:!0,expandButtonAriaLabel:this.rb.getText(\"CommentManager.searchField.expandButton.tooltip.txt\"),expandButtonTooltip:this.rb.getText(\"CommentManager.searchField.expandButton.tooltip.txt\"),collapseButtonAriaLabel:this.rb.getText(\"CommentManager.searchField.collapseButton.tooltip.txt\"),collapseButtonTooltip:this.rb.getText(\"CommentManager.searchField.collapseButton.tooltip.txt\"),enabled:{path:\"/children\",formatter:jQuery.proxy(function(e){return!!(e&&e.length>0||this._displayMode===sas.hc.ui.services.comment.petrichor.CommentManager.SEARCH_MODE)},this)}}),this._searchField.addStyleClass(\"sasCMSearchField\"),this._searchField.attachSearch(this._handleSearch,this),this._searchField.attachLiveChange(this._handleSearchLiveChange,this),this._searchField.attachStateChange(this._handleSearchStateChange,this),this._headerToolbar=new sas.hc.m.ResponsiveToolbar({id:this.getId()+\"-mainContainer-headerToolbar\",content:[this._searchField]}),e.setHeaderToolbar(this._headerToolbar),this._noWriteAccessMessageStrip=new sas.hc.m.MessageStrip({visible:!1,text:this.rb.getText(\"CommentManager.noWriteAccess.message.txt\"),type:sap.ui.core.MessageType.Information,showIcon:!0}).addStyleClass(\"sasCMNoWriteMessageStrip\"),e.addContent(this._noWriteAccessMessageStrip),this._commentListContainer=new sas.hc.m.ScrollContainer(this.getId()+\"-topicsContainer\",{vertical:!0,horizontal:!1}),this._commentListContainer.addStyleClass(\"sasCMTopicsContainer\"),this._commentListContainer.getScrollDelegate().setIconTabBar(this,this._fnScrollEnd),this._commentListContainer.getScrollDelegate().setMouseWheelCallbackFunction(this,this._fnMouseWheelScrollEnd),e.addContent(this._commentListContainer),this._commentList=new sas.hc.m.List(this.getId()+\"-commentList\",{visible:{path:\"/children\",formatter:function(e){return!(!e||!e.length)&&e.length>0}},showNoData:!1,selectionChange:jQuery.proxy(this._handleListSelectionChange,this)}),this._commentList.allowTextSelection(!0);var s=this,i=this._commentList.setNavigationItems;if(this._commentList.setNavigationItems=function(e,t){i.apply(this,arguments),void 0===s._controller._commentToBeFocused&&(0!==s._controller._currentPageFirstItemIndex?e.setFocusedIndex(this.getItems().length-2):e.setFocusedIndex(this.getItems().length-1));var o=$.proxy(e.onsapprevious,e),r=$.proxy(e.onsapnext,e),n=$.proxy(e.onsappageup,e),a=$.proxy(e.onsappagedown,e);e.onsapprevious=function(e){s._keyPressed=e.which,s._prevFocussedIndex=this.getFocusedIndex(),o(e)},e.onsapnext=function(e){s._keyPressed=e.which,s._prevFocussedIndex=this.getFocusedIndex(),r(e)},e.onsappageup=function(e){s._keyPressed=e.which,s._prevFocussedIndex=this.getFocusedIndex(),n(e)},e.onsappagedown=function(e){s._keyPressed=e.which,s._prevFocussedIndex=this.getFocusedIndex(),a(e)}},this._commentList.addStyleClass(\"sasCMCommentList\"),this._commentList.attachUpdateFinished(this._handleCommentListUpdateComplete,this),this._commentListContainer.addContent(this._commentList),this._sResizeListenerId||(this._sResizeListenerId=sap.ui.core.ResizeHandler.register(this,jQuery.proxy(this._handleCommentManagerResize,this))),this._commentEntryForm=new sas.hc.ui.services.comment.petrichor.components.CommentEntryForm(this.getId()+\"-topicEntry\",{},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.COMMENT,r),this._commentEntryForm.addStyleClass(\"sasCMTopicEntryForm\"),e.addContent(this._commentEntryForm),this._zeroStateNoComments=new sas.hc.m.ZeroState(this.getId()+\"-noComments\",{icon:sas.icons.HC.ZEROSTATESMALLCHATBOT,text:this.rb.getText(\"CommentManager.noComments.message.txt\"),visible:{path:\"/children\",formatter:function(e){return!e||!(!e||!e.hasOwnProperty(\"length\"))&&e.length<=0}}}).addStyleClass(\"sasCMNoCommentsZeroState\"),this._commentListContainer.addContent(this._zeroStateNoComments),this.getModel()||this.setModel(new sap.ui.model.json.JSONModel),this._controller||(this._controller=new sas.hc.ui.services.comment.petrichor.controller.CommentManagerController(this),this._controller.attachEvent(\"success\",this._successHanlder,this),this._controller.attachEvent(\"fail\",this._faultHandler,this)),!this._controller.getServiceProxy()){var o=new sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy;o.attachEvent(\"fail\",this._faultHandler,this),this._controller.setServiceProxy(o),this._controller.hasUserAccessWithCommentAndFileService(jQuery.proxy(this._handleUserAccessWithCommentAndFileService,this))}this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.submitted,this._handleCommentEntrySubmitted,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.textAreaFocused,this._handleCommentTextAreaFocused,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.textChanged,this._handleCommentTextChanged,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.canceled,this._handleCommentEntryFormCancelled,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.M_EVENTS.showMoreReplies,this._handleShowMoreReplies,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.M_EVENTS.showAllReplies,this._handleShowAllReplies,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.M_EVENTS.replyListUpdated,this._handleReplyListUpdateComplete,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.replyPress,this._handleReplyPress,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.getReplies,this._handleGetReplies,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.enableOthers,this._handleEnableOthers,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.editComment,this._handleEditComment,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.deleteComment,this._handleDeleteComment,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.preserveFocus,this._handlePreserveFocus,this),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.openAttachment,this._handleOpenAttachment,this),this._updateComplete=!1,this.setBusyIndicatorDelay(0),this.setBusy(!0);var n=new sap.ui.model.json.JSONModel;this.setModel(n,\"commentEntryFormModel\")},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleUserAccessWithCommentAndFileService=function(e){var t=this;e&&jQuery.each(e.authorizedLinks,function(e,s){var i=JSON.parse(e);\"/comments/comments\"===i.uri?t._handleUserWriteAccess(s):\"/files/files\"===i.uri&&t._handleUserCreateAccess(s)})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleUserWriteAccess=function(e){if(void 0!==e&&(this._hasWriteAccess=e,this._noWriteAccessMessageStrip.setVisible(!e),this._commentEntryForm.setVisible(e&&!this.getReadOnly()),this._commentList&&this._commentList.getItems()&&this._commentList.getItems().length>0))for(var t=this._commentList.getItems(),s=0;s<t.length;s++)t[s]._handleUserWriteAccess(e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleUserCreateAccess=function(e){!1===e&&this.setShowAttachment(!1)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleListSelectionChange=function(e){var t=e.getParameter(\"listItem\").getResourceUri(),s=e.getParameter(\"listItem\").getElementId();this.fireCommentInteracted({type:\"select\",resourceUri:t,elementId:s})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.applySettings=function(e){this._checkIfAttachmentsNeedsToBeDisabled()&&(e.showAttachment=!1),this._listTemplate=this._createCommentListTemplate(),sap.ui.core.Control.prototype.applySettings&&sap.ui.core.Control.prototype.applySettings.apply(this,arguments),sas.eventBus&&sas.eventBus.subscribe(sas.hc.ui.core.SETTINGS_CHANNEL,sas.hc.ui.core.SETTINGS_CHANGE,this._handleVisualEffects,this),this._createTitle(),this._commentList.setMode(this.getCommentListMode()),this._commentList.bindItems({path:\"/children\",template:this._listTemplate}),this._commentList.getBinding(\"items\").attachChange(this._setCommentTitleToMainContainer,this)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setShowTitle=function(e){this.setProperty(\"showTitle\",e),this._createTitle()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setCommentListMode=function(e){return e!==sap.m.ListMode.None&&e!==sap.m.ListMode.SingleSelectMaster?(sas.log.error(\"Comment Manager only supports None and SingleSelectMaster List Mode.\",\"\",\"sas.hc.ui.services.comment.petrichor.CommentManager\"),this.setProperty(\"commentListMode\",sap.m.ListMode.None)):this.setProperty(\"commentListMode\",e),this},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._createTitle=function(){var e=this.getAggregation(\"mainContainer\"),t=this.getTitle()?this.getTitle():this.rb.getText(\"CommentManager.title.txt\");this.getShowTitle()?e.getInfoToolbar()||(this._titleText=new sas.hc.m.Label({id:this.getId()+\"-label1\",text:t}),this._infoToolbar=new sas.hc.m.ResponsiveToolbar({id:this.getId()+\"-mainContainer-infoToolbar\",content:[this._titleText]}),e.setInfoToolbar(this._infoToolbar)):(e.setInfoToolbar(null),this._titleText&&(this._titleText.destroy(),this._titleText=null),this._infoToolbar&&(this._infoToolbar.destroy(),this._infoToolbar=null))},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._addConfiguredRestrictedFileExtensions=function(){if(sas.config&&sas.config.get(\"commons\")&&sas.config.get(\"commons\").blockedFileExtensions)for(var e=sas.config.get(\"commons\").blockedFileExtensions.split(\"|\"),t=0;t<e.length;t++){var s=e[t].trim();s&&\".\"!==s.charAt(0)&&(s=\".\"+s),-1===r.indexOf(s)&&r.push(s)}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._checkIfAttachmentsNeedsToBeDisabled=function(){if(sas.config&&sas.config.get(\"commons\")){var e=sas.config.get(\"commons\").blockCommentAttachments;return e=\"true\"===e||!0===e}return!1},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setShowAttachment=function(e){var t;t=this._checkIfAttachmentsNeedsToBeDisabled(),t&&(e=!1),this.setProperty(\"showAttachment\",e,!0),this._listTemplate.setShowAttachment(e);for(var s=this._commentList.getItems(),i=0;i<s.length;i++)s[i].setShowAttachment(e);this._commentEntryForm.setShowAttachment(e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setMaxPreviewLines=function(e){this.setProperty(\"maxPreviewLines\",e,!0);for(var t=this._commentList.getItems(),s=0;s<t.length;s++)t[s].setMaxPreviewLines(e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._setScrollToBottom=function(e){var t,s,i=0;if(!e||e.getSource()!==this._commentEntryForm||this._commentEntryForm.getEnabled()&&this._commentEntryForm._submitButton.getEnabled()){for(t=jQuery(this._commentListContainer.getDomRef(\"scroll\")).children(),s=0;s<t.length;s++)i+=jQuery(t[s]).height();var o=this._commentList.getItems(),r=o.length,n=r>0?$(o[r-1].getDomRef()).height():0;0!==this._controller._currentPageFirstItemIndex&&(i=$(this._commentList.getDomRef()).height()-$(this._commentListContainer.getDomRef()).height()-n),this._commentListContainer.scrollTo(0,i)}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._setScrollToTop=function(){var e=this._commentList.getItems(),t=$(e[0].getDomRef()).height();this._commentListContainer.scrollTo(0,t)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._postFetchTask=function(e){var t=this;clearTimeout(this._postFetchTaskTimeOut),this._postFetchTaskTimeOut=setTimeout(function(){t&&t._commentListContainer&&(t._wheelDeltaY?t._lastScrollTop=$(t._commentListContainer.getDomRef()).scrollTop()+t._wheelDeltaY:t._lastScrollTop=$(t._commentListContainer.getDomRef()).scrollTop(),e&&(t._setScrollBarToBoundary(),t._displayMode!==sas.hc.ui.services.comment.petrichor.CommentManager.SEARCH_MODE&&t.setFocusToTrackedComment()),t._searchFieldCleared&&(t._searchField.focus(),t._searchFieldCleared=!1),t._commentListContainer.getScrollDelegate().setIconTabBar(t,t._fnScrollEnd),t._commentListContainer.getScrollDelegate().setMouseWheelCallbackFunction(t,t._fnMouseWheelScrollEnd),t._updatePending?(t.setResourceUri(t._newResourceUri),t._controller.fetchComments(null,null,null,null),t._updatePending=!1):t._clearPending?(t.setProperty(\"resourceUri\",\"\",!0),t.getModel().setData(null),t.setBusy(!1),t._clearPending=!1):t.setBusy(!1),clearTimeout(t._postFetchTaskTimeOut))},500)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setTitle=function(e){return this.getProperty(\"title\")===e?this:(this.setProperty(\"title\",e,!0),this._titleText&&this._titleText.setText(e),this)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.getBusy=function(){var e=this.getAggregation(\"mainContainer\");return e?e.getBusy():sas.hc.ui.core.Control.prototype.getBusy.apply(this,arguments)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setBusy=function(e){var t=this.getAggregation(\"mainContainer\");return t?t.setBusy(e):sas.hc.ui.core.Control.prototype.setBusy.apply(this,arguments),this},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setShowEdit=function(e){var t,s,i=this._commentList.getItems();for(s=0;s<i.length;s++)t=i[s],this.getReadOnly()||this._editCapable||this._userInfo.userid!==t.getUserId()||(t.setShowEdit(e),t.setShowReplyEdit(e));return this.setProperty(\"showEdit\",e,!0),this},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setShowDelete=function(e){var t,s,i=this._commentList.getItems();for(s=0;s<i.length;s++)t=i[s],this.getReadOnly()||this._deleteCapable||this._userInfo.userid!==t.getUserId()||(t.setShowDelete(e),t.setShowReplyDelete(e));return this.setProperty(\"showDelete\",e,!0),this},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._getUrlParameter=function(e){for(var t=window.location.search.substring(1),s=t.split(\"&\"),i=0;i<s.length;i++){var o=s[i].split(\"=\");if(o[0]===e)return o[1]}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._setCommentTitleToMainContainer=function(){var e=0;if(this.getModel()&&this.getModel().getData()&&(e=this.getModel().getData().count),this._count!==e){if(this._titleText){var s=this.getTitle()?this.getTitle():this.rb.getText(\"CommentManager.title.txt\");e?(t&&(e=t.format(e)),this._titleText.setText(s+\"  (\"+e+\")\")):(this._titleText.setText(s),e=0)}this._count=e,this.fireCommentCountUpdated({commentCount:this._count})}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.onAfterRendering=function(){this._lastScrollTop&&this._commentListContainer.scrollTo(0,this._lastScrollTop),sas.hc.ui.core.Control.onAfterRendering&&sas.hc.ui.core.Control.onAfterRendering.apply(this,arguments),this._updateComplete||(this._setScrollEnd=!0,this._updateComplete=!0,this._controller._pageSize=this._calculatePagesize(),this.getResourceUri()?this._controller.fetchComments(null,null,null,null):this._postFetchTask()),jQuery.sap.byId(this.getId()+\"-image\").parent().parent().attr(\"aria-label\",\"No comments\"),jQuery.sap.byId(this.getId()+\"-image\").parent().parent().attr(\"tabindex\",0)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._calculatePagesize=function(){if(this._commentListContainer&&this._commentListContainer.getDomRef()){var e=jQuery(this._commentListContainer.getDomRef()).height(),t=Math.ceil(1.2*e/this._MIN_COMMENT_HEIGHT);return t=t>this._MIN_PAGESIZE?t:this._MIN_PAGESIZE}return this._MIN_PAGESIZE},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleReplyListUpdateComplete=function(e){e.oSource=e.getParameter(\"replyList\"),this._handleCommentListUpdateComplete(e),this._searchField.getValue()&&(i._dehighlight(this._commentList.getId()),i.hightlightSearchedString(this._searchField.getValue(),this._commentList.getId()))},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleCommentListUpdateComplete=function(e){var t,o,r,n;this._handleUserWriteAccess(this._hasWriteAccess),void 0!==this._controller._commentToBeFocused?this._applyFocusTimeOut=setTimeout(jQuery.proxy(function(){this._applyFocusToTrackedComment(this._controller._commentToBeFocused),this._postFetchTask(this._controller._commentToBeFocused),this._controller._commentToBeFocused=void 0},this),1e3):(this._firstItemToBeFocused?(this._firstItemToBeFocused=!1,this._controller._lastFetchTotalCount<=this._controller._currentPageFirstItemIndex+this._controller._pageSize?r=0:(n=this._controller._lastFetchTotalCount%this._controller._pageSize,this._keyPressed===s.ARROW_DOWN&&this._controller._lastFetchTotalCount-n-this._controller._pageSize===this._controller._currentPageFirstItemIndex?o=this._commentList.getItems()[this._controller._pageSize-n+1]:(o=this._commentList.getItems()[1],this._setScrollToTop()))):0!==this._controller._currentPageFirstItemIndex?(n=this._controller._lastFetchTotalCount%this._controller._pageSize,this._controller._lastFetchTotalCount<=this._controller._currentPageFirstItemIndex+this._controller._pageSize&&this._keyPressed===s.ARROW_UP&&n>0?(o=this._commentList.getItems()[n-1],r=n-1):(o=this._commentList.getItems()[this._commentList.getItems().length-2],this._setScrollToBottom())):(o=this._commentList.getItems()[this._commentList.getItems().length-1],this._setScrollToBottom()),this._postFetchTask(o),this._scrollerTouchedExplicitly&&(this._scrollerTouchedExplicitly=!1,this._setScrollTimeOut=setTimeout($.proxy(function(){0===this._controller._currentPageFirstItemIndex&&this._commentList.getItemNavigation()&&this._commentList.setNavigationItems(this._commentList.getItemNavigation(),this._commentList.getNavigationRoot()),o&&(void 0!==r?(o&&o.focus(),this._commentList.getItemNavigation().setFocusedIndex(r)):o.focus(),this._setScrollBarToBoundary())},this),500))),this._isSearchHighlighted&&(i._dehighlight(e.oSource.sId),this._isSearchHighlighted=!1),this._displayMode===sas.hc.ui.services.comment.petrichor.CommentManager.SEARCH_MODE&&(t=this._searchField.getValue(),i.hightlightSearchedString(t,e.oSource.sId),this._isSearchHighlighted=!0,this._searchField.focus()),this._isCommentBeingEditted=!1,this._isReplyBeingAdded=!1,this._keyPressed=null,this._prevFocussedIndex=-1},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._scroll=function(e){var t,i=$.sap.byId(this._commentListContainer.getId()),r=this._commentList.getItems(),n=r.length;if(this.scrollDir=\"\",this.searchStr=null,0!==n){if(i.scrollTop()<this._lastScrollTop?this.scrollDir=o.MOVE_UP:i.scrollTop()>=this._lastScrollTop&&(this.scrollDir=o.MOVE_DOWN,this._firstItemToBeFocused=!0),e&&\"wheel\"===e.type){if(this._lastScrollTop=i.scrollTop()+e.originalEvent.deltaY,sap.ui.Device.browser.firefox&&this.scrollDir===o.MOVE_DOWN){var a=$(r[n-1].getDomRef()).height(),c=i[0].scrollHeight-this._lastScrollTop-i.height()-a;c<5&&(this._lastScrollTop+=100)}}else this._lastScrollTop=i.scrollTop();if(this._keyPressed&&this._prevFocussedIndex>-1)switch(this._keyPressed){case s.ARROW_DOWN:0!==this._controller._currentPageFirstItemIndex&&this._prevFocussedIndex===this._commentList.getItems().length-2&&(this._firstItemToBeFocused=!0);break;case s.PAGE_UP:if(this._canMoveUP()){if(1!==this._prevFocussedIndex)return this._setScrollBarToBoundary(),this._commentList.getItems()[1].getDomRef().focus(),this._keyPressed=null,void(this._prevFocussedIndex=-1);this._firstItemToBeFocused=!0}break;case s.PAGE_DOWN:if(this._canMoveDOWN()){var m=this._commentList.getItems().length-2;if(this._prevFocussedIndex!==m)return this._setScrollBarToBoundary(),this._commentList.getItems()[m].getDomRef().focus(),this._keyPressed=null,void(this._prevFocussedIndex=-1)}}this._displayMode===sas.hc.ui.services.comment.petrichor.CommentManager.SEARCH_MODE&&(this.searchStr=this._searchString),this._isCommentBeingEditted||this._isReplyBeingAdded||!(this.scrollDir===o.MOVE_UP&&this._canMoveUP()||this.scrollDir===o.MOVE_DOWN&&this._canMoveDOWN())||(this._enableOtherInteractions(!0),this._commentListContainer.getScrollDelegate().setIconTabBar(this,void 0),t=[],this.searchStr&&t.push(this.searchStr),this._controller.fetchComments(this.scrollDir,t),this._scrollerTouchedExplicitly=!0),(this._isCommentBeingEditted||this._isReplyBeingAdded)&&(this.scrollDir===o.MOVE_UP&&this._canMoveUP()||this.scrollDir===o.MOVE_DOWN&&this._canMoveDOWN())?(this._messageDialog||(this._messageDialog=new sas.hc.m.MessageDialog({type:sas.hc.m.MessageDialogAction.Warning,title:this.rb.getText(\"CommentManager.scroll.message.title.txt\"),text:this.rb.getText(\"CommentManager.scroll.message.txt\"),buttonActions:[this.rb.getText(\"CommentManager.scroll.postNowButton.txt\"),this.rb.getText(\"CommentManager.scroll.discardTextButton.txt\")],autoDestroy:!1,buttonPress:jQuery.proxy(function(e){e.getParameter(\"origin\").getText()===this.rb.getText(\"CommentManager.scroll.postNowButton.txt\")&&(this._postEditedCommentBeforeNextPageFetch(),this._commentListContainer.getScrollDelegate().setIconTabBar(this,void 0),this._scrollerTouchedExplicitly=!0),this._setScrollBarToBoundary(),this._enableOtherInteractions(!0)},this)})),this._messageDialog.open()):this._setScrollBarToBoundary()}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._fnScrollEnd=function(){this._scroll()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._fnMouseWheelScrollEnd=function(e){this._scroll(e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._postEditedCommentBeforeNextPageFetch=function(){var e=this.getModel(\"commentEntryFormModel\").getData();if(e.commentId)if(this.getShowAttachment()&&e.attachments&&e.attachments>0){var t=new sas.hc.ui.services.comment.petrichor.util.AttachmentReader(e.attachments);t.attachEvent(\"complete\",this._handleAttachmentComplete,this),t.readAttachment()}else this._updateComment(e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleAttachmentComplete=function(e){var t=this.getModel(\"commentEntryFormModel\").getData(),s=e.getParameter(\"attachments\"),i=e.getParameter(\"errorFileNames\");if(void 0!==i&&i.length>0){var o=function(e){var o=this;\"Yes\"===e.getParameter(\"origin\").getMessageDialogAction()&&(i.forEach(function(e,t){for(var s=0;s<o.attachments.length;s++)e===o.attachments[s].fileRef.name&&(delete o.attachments[s].fileRef,o.attachments.splice(s,1))}),t.addAttachments=s,this._updateComment(t))};sas.hc.m.MessageDialog.error({text:this.rb.getText(\"Attachment.uploadFile.error.messages.fmt\",[i.join(\", \")]),title:this.rb.getText(\"Attachment.addAttachment.message.title.txt\"),buttonActions:[sas.hc.m.MessageDialogAction.Yes,sas.hc.m.MessageDialogAction.No],buttonPress:jQuery.proxy(o,this)})}else t.addAttachments=s,this._updateComment(t)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._updateComment=function(e){var t=new sas.hc.ui.services.comment.petrichor.model.Comment;t.author=this._userInfo.userid,t.resourceUri=this.getResourceUri(),t.elementId=this.getElementId(),t.text=e.commentText.trim(),t.id=e.commentId,\"\"!==e.parentId&&(t.parentId=e.parentId),t.isTextChanged=e.isTextChanged,t.modifiedTimeStamp=e.modifiedTimeStamp,this.getShowAttachment()&&(t.attachmentsToAdd=e.addAttachments,t.attachmentsToDelete=e.deleteAttachments),this._controller.updateComment(t,!1)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleCommentManagerResize=function(){this._isCommentEditMode&&(this._controller._pageSize=this._calculatePagesize(),this._controller.fetchComments())},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._createCommentListTemplate=function(){var e=n(this);e.addStyleClass(\"sasCMCommentListItem\"),e.setShowAttachment(this.getShowAttachment()),e.setMaxPreviewLines(this.getMaxPreviewLines()),this._displayMode===sas.hc.ui.services.comment.petrichor.CommentManager.SEARCH_MODE?(e.setIsSearchMode(!0),e.setSearchString(this._searchField.getValue().toLocaleLowerCase()),e.setMaxPreviewLines(0)):(e.setIsSearchMode(!1),e.setSearchString(\"\"));var t=this,s=function(){t._commentList._oItemNavigation&&t._commentList.getNavigationRoot()&&t._commentList.setNavigationItems(t._commentList._oItemNavigation,t._commentList.getNavigationRoot())};return e.addEventDelegate({onAfterRendering:function(){s()}}),e};var n=function(t){return new sas.hc.ui.services.comment.petrichor.components.CommentListItem(t.getId()+\"-commentListItem\",{resourceUri:\"{resourceUri}\",elementId:\"{elementId}\",userId:\"{author}\",commentId:\"{id}\",parentId:\"{parentId}\",topicName:\"{subject}\",userName:\"{authorDisplayName}\",date:{path:\"createdOn\",formatter:function(t){var s=new Date(t);return e?e.format(sas.hc.ui.core.util.CalendarUtil.jsDateToSASDateTime(s)):sap.ui.core.format.DateFormat.getDateTimeInstance({style:\"medium\"}).format(s)}},isEditMode:\"{isEditMode}\",modifiedDate:\"{modifiedTimeStamp}\",text:\"{text}\",attachments:\"{attachments}\",showEdit:{path:\"isEditable\",formatter:jQuery.proxy(t._hasEditCapable,t),mode:sap.ui.model.BindingMode.OneWay},showDelete:{path:\"isDeletable\",formatter:jQuery.proxy(t._hasDeleteCapable,t),mode:sap.ui.model.BindingMode.OneWay},showReplyEdit:t.getShowEdit(),showReplyDelete:t.getShowDelete(),readOnly:\"{isReadOnly}\",showAttachment:t.getShowAttachment(),\ncommentListType:sas.hc.ui.services.comment.petrichor.components.CommentListItem.COMMENT},r)};sas.hc.ui.services.comment.petrichor.CommentManager.prototype._hasEditCapable=function(e){return!(!this.getShowEdit()||!e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._hasDeleteCapable=function(e){return!(!this.getShowDelete()||!e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setFocusToTrackedComment=function(){this._trackComment.isClear()||this._applyFocusToTrackedComment()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleSearch=function(e){var t,s=e.oSource.getValue(),i=[];\"\"!==s&&(this._displayMode=sas.hc.ui.services.comment.petrichor.CommentManager.SEARCH_MODE,t=s.replace(/\\\"/g,'\"\"'),i.push(t),this._searchString=s,this._controller._searchString=s,this._controller.setPaginatorFilter(\"\"),this._setIsSearchMode(!0),this._commentListContainer.getScrollDelegate().setIconTabBar(this,void 0),this._controller.fetchComments(null,i,null,o.UPDATE_OP))},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleSearchLiveChange=function(e){\"\"===e.oSource.getValue()&&(this._displayMode=sas.hc.ui.services.comment.petrichor.CommentManager.NORMAL_MODE,this._controller.setPaginatorFilter(\"\"),this._searchString=\"\",this._searchFieldCleared=!0,this._controller._searchString=\"\",this._setIsSearchMode(!1),this._controller.fetchComments())},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._setIsSearchMode=function(e){for(var t=this._commentList.getItems(),s=0;s<t.length;s++)t[s].setIsSearchMode(e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setAssociatedObject=function(e){return this.setResourceUri(e)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.getAssociatedObject=function(){return this.getResourceUri()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setResourceUri=function(e){return e?(this.setProperty(\"resourceUri\",e,!0),this):void sas.hc.m.MessageDialog.error({text:this.rb.getText(\"Error.null.resourceUri.fmt\",[e]),title:this.rb.getText(\"CommentManager.txt\")})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setReadOnly=function(e){this.setProperty(\"readOnly\",e,!0),this._commentEntryForm.setVisible(this._hasWriteAccess&&!e);var t=this.getModel().getData().children;if(t)for(var s=0;s<t.length;s++){var i=t[s];i.isReadOnly=e;var o=i.replies?i.replies.children:void 0;if(o)for(var r=0;r<o.length;r++){var n=o[r];n.isReadOnly=e}}return this.getModel().refresh(),this},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._isReadOnly=function(){return!this._commentEntryForm.getVisible()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setServiceProxy=function(e){return this._controller&&this._controller.setServiceProxy(e),this},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.getServiceProxy=function(){return this._controller.getServiceProxy()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.setUpdateStatusCallbackFn=function(e){if(\"function\"!=typeof e&&void 0!==e)return sas.log.error(\"fnCallback should be of type function.\"),this;this._fnUpdateStatusCallback=e},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._successHanlder=function(){if(this._isUpdateCM&&this._fnUpdateStatusCallback){this._isUpdateCM=!1;var e={status:200,statusText:\"OK\"};this._fnUpdateStatusCallback(e)}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._faultHandler=function(e){var t=e.getParameters();if(this._isUpdateCM&&this._fnUpdateStatusCallback){this._isUpdateCM=!1,sas.log.error(\"Comment Manager update fault : \"+t.status+\" - \"+this.rb.getText(\"CommentManager.message.errorMessage.txt\"));var s={status:t.status,statusText:this.rb.getText(\"CommentManager.message.errorMessage.txt\")};this._fnUpdateStatusCallback(s)}else 400===t.status?(sas.log.info(\"Get Comments Fault : \"+t.statusText),sas.hc.m.MessageDialog.error({text:this.rb.getText(\"CommentManager.message.errorMessage.txt\"),title:this.rb.getText(\"CommentManager.message.title.txt\")})):404===t.status?(this._originalComments=new sas.hc.ui.services.comment.petrichor.model.CommentsInfo,this.getModel().setData(this._originalComments)):500===t.status?sas.hc.m.MessageDialog.error({text:this.rb.getText(\"CommentManager.message.serviceFail.txt\"),title:this.rb.getText(\"CommentManager.message.title.txt\")}):0===t.status?sas.hc.m.MessageDialog.error({text:this.rb.getText(\"CommentManager.message.errorMessage.txt\"),title:this.rb.getText(\"CommentManager.message.title.txt\")}):sas.hc.m.MessageDialog.error({text:t.statusText,title:this.rb.getText(\"CommentManager.txt\")});this._postFetchTask()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.update=function(e,t){this._isUpdateCM=!0,this.getBusy()?(this._newResourceUri=e,this._updatePending=!0,this._clearPending=!1):(this.setResourceUri(e),this.setElementId(t),this._controller.fetchComments()),this.clearSearchFieldAndCommentEntryForm()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.clear=function(){this.getBusy()?(this._clearPending=!0,this._updatePending=!1):(this.setProperty(\"resourceUri\",\"\",!0),this.getModel().setData(null),this._postFetchTask()),this.clearSearchFieldAndCommentEntryForm()},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.clearSearchFieldAndCommentEntryForm=function(){this._commentEntryForm.getVisible()&&(this._commentEntryForm.setTopicName(\"\"),this._commentEntryForm.setCommentText(\"\"),this._commentEntryForm.expandForm(!1),this._commentEntryForm.setAttachments([])),this._searchField.setValue(\"\"),this._searchField.setEnabled(!0),this._setIsSearchMode(!1),this._listTemplate.setIsSearchMode(!1),this._listTemplate.setMaxPreviewLines(this.getMaxPreviewLines()),this._controller._searchString=\"\",this._displayMode=sas.hc.ui.services.comment.petrichor.CommentManager.NORMAL_MODE},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.getCommentEntryForm=function(){return this._commentEntryForm},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleCommentEntrySubmitted=function(e){if(this._commentListContainer.getScrollDelegate().setIconTabBar(this,void 0),this.getResourceUri()){this.setBusy(!0);var t=new sas.hc.ui.services.comment.petrichor.model.Comment;t.author=this._userInfo.userid,t.resourceUri=this.getResourceUri(),t.elementId=this.getElementId(),t.text=e.mParameters.commentText,e.mParameters.type===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT?(t.id=e.mParameters.commentId,t.resourceUri=e.mParameters.resourceUri,t.elementId=e.mParameters.elementId,\"\"!==e.mParameters.parentId&&(t.parentId=e.mParameters.parentId),t.isTextChanged=e.mParameters.isTextChanged,t.modifiedTimeStamp=e.mParameters.modifiedTimeStamp,this.getShowAttachment()&&(t.attachmentsToAdd=e.mParameters.addAttachments,t.attachmentsToDelete=e.mParameters.deleteAttachments),this._controller.updateComment(t)):(e.mParameters.type===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.REPLY&&(t.parentId=e.mParameters.commentId,t.resourceUri=e.mParameters.resourceUri,t.elementId=e.mParameters.elementId),this.getShowAttachment()&&(t.attachments=e.mParameters.addAttachments),this._controller.addComment(t))}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleCommentEntryFormCancelled=function(e){this._isCommentEditMode=!1,e.getParameter(\"type\")===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT?this._isCommentBeingEditted=!1:e.getParameter(\"type\")===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.REPLY&&(this._isReplyBeingAdded=!1)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleEditComment=function(e){this._isCommentEditMode=!0,this._commentListContainer.getScrollDelegate()&&this._commentListContainer.getScrollDelegate().scrollToElement(e.oSource.$()[0]),this.fireCommentInteracted({type:\"edit\",resourceUri:e.getSource().getResourceUri(),elementId:e.getSource().getElementId()})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleCommentTextChanged=function(e){e.getParameter(\"type\")===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.REPLY?this._isReplyBeingAdded=!0:e.getParameter(\"type\")===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT&&(this._isCommentBeingEditted=!0)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleDeleteComment=function(e){var t=e.getParameter(\"comment\");t&&(this._commentListContainer.getScrollDelegate().setIconTabBar(this,void 0),this._controller.deleteComment(t)),t||this.fireCommentInteracted({type:\"delete\",resourceUri:e.getSource().getResourceUri(),elementId:e.getSource().getElementId()})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handlePreserveFocus=function(e){this._trackCommentToFocusLater(e.mParameters.commentId)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._trackCommentToFocusLater=function(e){var t,s,i,o,r;for(t=this.getModel(),s=t.getData(),this._trackComment.clear(),o=0;s.children&&o<s.children.length;o++){if(i=s.children[o],i.id===e){this._trackComment.setTargetCommentId(e),o>0&&this._trackComment.setPrevCommentId(r.id),o+1<s.children.length&&this._trackComment.setNextCommentId(s.children[o+1].id);break}r=i}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._applyFocusToTrackedComment=function(e){if(this._commentList&&e){var t,s,i,o;for(this.focus(),s=this._commentList,i=s.getItems(),t=0;t<i.length;t++)if(o=i[t],e&&\"object\"==typeof e&&o.getCommentId()===e.parentId)for(var r,n=o.getAggregation(\"replyForm\").getReplyList(),a=n.getItems(),c=0;c<a.length;c++)r=a[c],r.getCommentId()===e.id&&(n.onmousedown(),r.focus());else if(o.getCommentId()===this._controller._commentToBeFocused.id){s.onmousedown(),o.focus();break}}},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleOpenAttachment=function(e){this._controller.openAttachment(e.getParameter(\"attachment\"))},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleGetReplies=function(e){this._controller.getReplies(e.getParameters()),this.fireCommentInteracted({type:\"showHideReply\",resourceUri:e.getSource().getResourceUri(),elementId:e.getSource().getElementId()})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleReplyPress=function(e){this.fireCommentInteracted({type:\"reply\",resourceUri:e.getSource().getResourceUri(),elementId:e.getSource().getElementId()})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleShowMoreReplies=function(e){this._controller.fetchComments(null,null,null,null,e.getParameters()),this.fireCommentInteracted({type:\"showMoreReplies\",resourceUri:e.getSource().getResourceUri(),elementId:e.getSource().getElementId()})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleShowAllReplies=function(e){this._controller.fetchReplyComments(e.getParameters(),!0),this.fireCommentInteracted({type:\"showAllReplies\",resourceUri:e.getSource().getResourceUri(),elementId:e.getSource().getElementId()})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleEnableOthers=function(e){var t=this.getModel().getData();t.children&&0===t.children.length&&\"\"===this._searchField.getValue()?this._enableOtherInteractions(!1,e.oSource):this._enableOtherInteractions(e.mParameters.isEnable,e.oSource)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._enableOtherInteractions=function(e,t){var s,i,o=this._commentList.getItems();for(this._searchField!==t&&this._searchField.setEnabled(e),this._commentEntryForm!==t&&this._commentEntryForm.setEnabled(e),s=0;s<o.length;s++)i=o[s],i.setEnableEdit(e),i.setEnableDelete(e),i._enableReplyInteractions(e,t)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.addRestrictedFileTypes=function(e){e&&(r=r.concat(e))},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._getNoCommentsText=function(e){return this._displayMode===sas.hc.ui.services.comment.petrichor.CommentManager.SEARCH_MODE?this.rb.getText(\"CommentManager.noCommentsForSearch.message.txt\"):this.rb.getText(\"CommentManager.noComments.message.txt\")},sas.hc.ui.services.comment.petrichor.CommentManager.prototype.exit=function(){sas.eventBus.unsubscribe(sas.hc.ui.core.SETTINGS_CHANNEL,sas.hc.ui.core.SETTINGS_CHANGE,this._handleVisualEffects,this),sas.hc.ui.core.Control.prototype.exit&&sas.hc.ui.core.Control.prototype.exit.apply(this,arguments),clearTimeout(this._postFetchTaskTimeOut),clearTimeout(this._applyFocusTimeOut),clearTimeout(this._setScrollTimeOut),this._listTemplate&&(this._listTemplate.destroy(),this._listTemplate=null),this._commentList&&(this._commentList.getBinding(\"items\").detachChange(this._setCommentTitleToMainContainer,this),this._commentList.destroy(),this._commentList=null),this._commentListContainer&&(this._commentListContainer.destroy(),this._commentListContainer=null),this._noWriteAccessMessageStrip.destroy(),this._noWriteAccessMessageStrip=null,this._searchField&&(this._searchField.detachEvent(\"search\",this._handleSearch),this._searchField.detachEvent(\"liveChange\",this._handleSearchLiveChange),this._searchField.destroy(),this._searchField=null),this._messageDialog&&this._messageDialog.destroy(),this._commentEntryForm&&(this._commentEntryForm.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.TEXTAREARESIZED,this._setScrollToBottom,this),this._commentEntryForm.destroy(),this._commentEntryForm=null),this.getModel()&&this.getModel().destroy(),this._trackComment&&this._trackComment.destroy(),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.submitted,this._handleCommentEntrySubmitted,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.textAreaFocused,this._handleCommentTextAreaFocused,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.textChanged,this._handleCommentTextChanged,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.canceled,this._handleCommentEntryFormCancelled,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.M_EVENTS.showMoreReplies,this._handleShowMoreReplies,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.M_EVENTS.showAllReplies,this._handleShowAllReplies,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.M_EVENTS.replyListUpdated,this._handleReplyListUpdateComplete,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.replyPress,this._handleReplyPress,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.getReplies,this._handleGetReplies,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.enableOthers,this._handleEnableOthers,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.deleteComment,this._handleDeleteComment,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.preserveFocus,this._handlePreserveFocus,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.openAttachment,this._handleOpenAttachment,this),this.detachEvent(sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS.editComment,this._handleEditComment,this),this._sResizeListenerId&&(sap.ui.core.ResizeHandler.deregister(this._sResizeListenerId),this._sResizeListenerId=null)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._canMoveUP=function(){var e=this._commentList.getItems(),t=$(e[0].getDomRef()).height();return this._lastScrollTop<t/2&&this._controller._lastFetchTotalCount>this._controller._currentPageFirstItemIndex+this._controller._pageSize},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._canMoveDOWN=function(){var e=this._commentList.getItems(),t=e.length,s=$(e[t-1].getDomRef()).height(),i=$.sap.byId(this._commentListContainer.getId());return 0!==this._controller._currentPageFirstItemIndex&&i[0].scrollHeight-this._lastScrollTop-i.height()<s/2},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._setScrollBarToBoundary=function(){var e=this._commentList.getItems(),t=e.length,s=$(e[0].getDomRef()).height(),i=$(e[t-1].getDomRef()).height();this._controller._lastFetchTotalCount>this._controller._pageSize&&(s=$(e[1].getDomRef()).height(),i=$(e[t-2].getDomRef()).height()),this._lastScrollTop<s/2&&this._controller._lastFetchTotalCount>this._controller._currentPageFirstItemIndex+this._controller._pageSize?(this._lastScrollTop=s,this._commentListContainer.scrollTo(0,this._lastScrollTop)):0!==this._controller._currentPageFirstItemIndex&&this._lastScrollTop>$(this._commentList.getDomRef()).height()-$(this._commentListContainer.getDomRef()).height()-i&&(this._lastScrollTop=$(this._commentList.getDomRef()).height()-$(this._commentListContainer.getDomRef()).height()-i,this._commentListContainer.scrollTo(0,this._lastScrollTop))},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleCommentTextAreaFocused=function(e){e.getParameter(\"focused\")?this._commentList.setKeyboardMode(sap.m.ListKeyboardMode.Edit):this._commentList.setKeyboardMode(sap.m.ListKeyboardMode.Navigation)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleSearchStateChange=function(e){this._isSearchFieldExpanded=e.getParameter(\"isExpanded\"),this._handleVisualEffectsToggle(this)},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleVisualEffects=function(e,t,s){var i=this;s&&s.forEach(function(e,t){e&&e.field&&e.field.getId()===sas.hc.ui.core.GlobalSettings.PLAY_VISUAL_EFFECTS&&i._handleVisualEffectsToggle()})},sas.hc.ui.services.comment.petrichor.CommentManager.prototype._handleVisualEffectsToggle=function(){var e=this.getAggregation(\"mainContainer\");if(e){var t=$(\"#\"+e.getId().concat(\"-content\"));e.getHeaderToolbar().toggleStyleClass(\"sasCMHeaderToolbarAnimateDisabled\",!sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&this._isSearchFieldExpanded),t.toggleClass(\"sasCMCommentsContainerAnimateDisabled\",!sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&this._isSearchFieldExpanded),this.getShowTitle()&&e.getInfoToolbar().toggleStyleClass(\"sasCMInfoToolbarAnimateDisabled\",!sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&this._isSearchFieldExpanded),this.getShowTitle()&&e.getInfoToolbar().toggleStyleClass(\"sasCMInfoToolbarAnimateStopDisabled\",!sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&!this._isSearchFieldExpanded),e.getHeaderToolbar().toggleStyleClass(\"sasCMHeaderToolbarAnimate\",sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&this._isSearchFieldExpanded),t.toggleClass(\"sasCMCommentsContainerAnimate\",sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&this._isSearchFieldExpanded),this.getShowTitle()&&e.getInfoToolbar().toggleStyleClass(\"sasCMInfoToolbarAnimate\",sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&this._isSearchFieldExpanded),this.getShowTitle()&&e.getInfoToolbar().toggleStyleClass(\"sasCMInfoToolbarAnimateStop\",sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&!this._isSearchFieldExpanded),sas.hc.ui.core.settings.GlobalSettingsHelper.getPlayVisualEffects()&&this.getShowTitle()&&e.getInfoToolbar().removeStyleClass(\"sasCMInfoToolbarAnimateDisabled\")}},sas.hc.ui.services.comment.petrichor.CommentManager.NORMAL_MODE=\"normal\",sas.hc.ui.services.comment.petrichor.CommentManager.SEARCH_MODE=\"search\",sas.hc.ui.services.comment.petrichor.CommentManager.URL_PARAM_PERF=\"cmPerf\"}();",
	"sas/hc/ui/services/comment/petrichor/CommentManagerRenderer.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.CommentManagerRenderer\"),sas.hc.ui.services.comment.petrichor.CommentManagerRenderer={},sas.hc.ui.services.comment.petrichor.CommentManagerRenderer.render=function(e,r){e.write(\"<div\"),e.writeControlData(r),e.addStyle(\"width\",r.getWidth()),e.addStyle(\"height\",r.getHeight()),e.writeStyles(),e.write(\">\"),e.renderControl(r.getAggregation(\"mainContainer\")),e.write(\"</div>\")};",
	"sas/hc/ui/services/comment/petrichor/components/CommentEntryForm.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.components.CommentEntryForm\"),jQuery.sap.require(\"sap.ui.core.Core\"),jQuery.sap.require(\"sas.hc.ui.core.theme.IconInitialization\"),jQuery.sap.require(\"sas.hc.ui.layout.VerticalLayout\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentEntryFormRenderer\"),jQuery.sap.require(\"sas.hc.ui.layout.HorizontalLayout\"),jQuery.sap.require(\"sas.hc.m.TextArea\"),jQuery.sap.require(\"sas.hc.m.Button\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.Attachment\"),jQuery.sap.require(\"sas.hc.ui.unified.FileUploader\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil\"),jQuery.sap.require(\"sas.hc.m.ScrollContainer\"),jQuery.sap.require(\"sas.hc.m.List\"),jQuery.sap.require(\"sap.ui.model.json.JSONModel\"),jQuery.sap.require(\"sas.hc.m.CustomListItem\"),jQuery.sap.require(\"sas.hc.ui.core.Icon\"),jQuery.sap.require(\"sas.hc.m.Link\"),jQuery.sap.require(\"sap.ui.core.library\"),jQuery.sap.require(\"sas.hc.m.MessageDialog\"),jQuery.sap.require(\"sas.hc.m.library\"),jQuery.sap.require(\"jquery.sap.dom\"),function(){\"use strict\";var t,e=sap.ui.requireSync(\"sap/ui/events/KeyCodes\");sas.hc.ui.layout.VerticalLayout.extend(\"sas.hc.ui.services.comment.petrichor.components.CommentEntryForm\",{metadata:{properties:{formType:{type:\"string\",defaultValue:\"topicType\"},topicName:{type:\"string\"},commentText:{type:\"string\"},commentId:{type:\"string\",defaultValue:void 0},modifiedTimeStamp:{type:\"string\"},parentId:{type:\"string\",defaultValue:void 0},resourceUri:{type:\"string\",defaultValue:void 0},elementId:{type:\"string\",defaultValue:void 0},attachments:{type:\"object[]\",defaultValue:[]},showAttachment:{type:\"boolean\",group:\"Appearance\",defaultValue:!0}},events:{submitted:{enableEventBubbling:!0},canceled:{enableEventBubbling:!0},enableOthers:{enableEventBubbling:!0},textAreaFocused:{enableEventBubbling:!0},textChanged:{enableEventBubbling:!0}}},constructor:function(e,s,n,o){sas.hc.ui.layout.VerticalLayout.apply(this,arguments),this.setFormType(n),\"string\"!=typeof e&&arguments.length>0&&\"string\"===jQuery.type(s)&&(o=n,n=s),!t&&o&&(t=o)},rb:sap.ui.getCore().getLibraryResourceBundle(\"sas.hc.ui.services.comment\"),renderer:sas.hc.ui.services.comment.petrichor.components.CommentEntryFormRenderer}),sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS={submitted:\"submitted\",canceled:\"canceled\",enableOthers:\"enableOthers\",textAreaFocused:\"textAreaFocused\",textChanged:\"textChanged\"},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.init=function(){var t;this.addStyleClass(\"sasCMCommentEntryForm\"),this._attachmentLoadCount=0,this._attachmentLoadErrorOccured=!1,this._attachmentsToAdd=[],this._attachmentsToDelete=[],this._isCommentTextChanged=!1,this._isExistingAttachmentRemoved=!1,this._MAX_COMMENT_CHARS=1e3,this._MAX_FILE_SIZE=100,this._commentText=new sas.hc.m.TextArea(this.getId()+\"-commentText\",{autoExpandable:!0,showValueStateMessage:!1,maxLength:this._MAX_COMMENT_CHARS,placeholder:this.rb.getText(\"CommentEntryForm.petrichor.comment.placeholder.message.txt\")}).addStyleClass(\"sasCMCommentEntryField\"),this._commentText.attachLiveChange(this._handleCommentLiveChange,this),this._commentText.addEventDelegate({onfocusin:function(){this.fireTextAreaFocused({focused:!0})},onfocusout:function(){this.fireTextAreaFocused({focused:!1})}},this),this.addContent(this._commentText),this._commentText.attachResize(this._textAreaResized,this),this._attachmentsContainer=new sas.hc.m.ScrollContainer(this.getId()+\"-attachmentsContainer\",{vertical:!0,horizontal:!1,width:\"100%\",visible:!1}).addStyleClass(\"sasCMCommentEntryAttachmentContainer\"),this._attachmentList=new sas.hc.m.List(this.getId()+\"-attachmentList\",{width:\"100%\",mode:\"Delete\",showNoData:!1,delete:jQuery.proxy(this._handleRemoveAttachmentPress,this)}),this._attachmentsContainer.addContent(this._attachmentList),this.addContent(this._attachmentsContainer),this._attachmentList.bindAggregation(\"items\",\"/data\",jQuery.proxy(this._listItemFactoryFunction,this)),t=new sap.ui.model.json.JSONModel,this._attachmentList.setModel(t),this._createControlBar(),this.expandForm(!1)},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.applySettings=function(t){sas.hc.ui.layout.VerticalLayout.prototype.applySettings&&sas.hc.ui.layout.VerticalLayout.prototype.applySettings.apply(this,arguments),this.getFormType()===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT&&(this.bindProperty(\"commentId\",\"commentEntryFormModel>/commentId\"),this.bindProperty(\"parentId\",\"commentEntryFormModel>/parentId\"),this.bindProperty(\"attachments\",\"commentEntryFormModel>/attachments\"),this.bindProperty(\"modifiedTimeStamp\",\"commentEntryFormModel>/modifiedTimeStamp\"),this._commentText.bindProperty(\"value\",\"commentEntryFormModel>/commentText\"))},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._listItemFactoryFunction=function(t,e){var s,n,o,i,r,a,m,c,h;return h=e.sPath,c=h.lastIndexOf(\"/\"),m=h.slice(c+1,h.length),a=new sas.hc.m.CustomListItem(this.getId()+\"-attachment-\"+m+\"-customListItem\",{}),a.addStyleClass(\"sasCMAttachmentHolder\"),s=new sas.hc.ui.layout.HorizontalLayout(this.getId()+\"-attachment-\"+m+\"hLayout\",{}),a.addContent(s),a.getDeleteControl(!0).setTooltip(this.rb.getText(\"Attachment.removeIcon.tooltip.txt\")),n=e.getProperty(\"name\"),o=n.toLowerCase().substring(n.lastIndexOf(\".\")),i=new sas.hc.ui.core.Icon(this.getId()+\"-attachment-\"+m+\"-icon\",{src:sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil.getFileTypeIcon(o)}),s.addContent(i),r=new sas.hc.m.Link(this.getId()+\"-attachment-\"+m+\"-attachmentLink\",{text:\"{name}\",textDirection:sap.ui.core.TextDirection.LTR}),r.addStyleClass(\"sasCMAttachmentLink\"),s.addContent(r),a},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._textAreaResized=function(t){this.fireEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.TEXTAREARESIZED),this.onAfterRendering()},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.onkeydown=function(t){t.keyCode!==e.HOME&&t.keyCode!==e.END||t.stopPropagation()},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.onAfterRendering=function(){this._setCommentTextMaxHeight()},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._setCommentTextMaxHeight=function(){if(this.getDomRef()&&\"none\"!==$(this.getDomRef()).css(\"maxHeight\")&&!this._commentText.getMaxHeight()){var t,e,s,n=this.getParent().getDomRef().offsetHeight,o=$(this.getDomRef()).css(\"maxHeight\"),i=parseInt($(this.getDomRef()).css(\"paddingTop\")),r=parseInt($(this.getDomRef()).css(\"paddingBottom\")),a=this.getContent(),m=0,c=0,h=0;for(t=0;t<a.length;t++)a[t]!==this._commentText&&(e=a[t].getDomRef()?a[t].getDomRef().offsetHeight:0,m+=e);this._attachmentsContainer.getDomRef()&&(c=parseInt($(this._attachmentsContainer.getDomRef()).css(\"marginTop\"))),this._controlBar.getDomRef()&&(h=parseInt($(this._controlBar.getDomRef()).css(\"marginBottom\"))),-1!==String(o).indexOf(\"%\")&&(o=n*(parseInt(o)/100)),o=parseInt(o),s=o-m-i-r-0-c-h,s&&(s+=\"px\",this._commentText.setProperty(\"maxHeight\",s,!0),$(this._commentText.getDomRef(\"inner\")).css(\"maxHeight\",s))}},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._createControlBar=function(){this._controlBar=new sas.hc.ui.layout.HorizontalLayout(this.getId()+\"-controlBar\"),this._controlBar.addStyleClass(\"sasCMCommentEntryControlBar\"),this._attachmentUploader=new sas.hc.ui.unified.FileUploader(this.getId()+\"-attachmentUploader\",{tooltip:this.rb.getText(\"CommentEntryForm.Attachment.tooltip.txt\"),buttonOnly:!0,iconOnly:!0,icon:sas.icons.HC.ATTACH,multiple:!0,maximumFileSize:this._MAX_FILE_SIZE,sameFilenameAllowed:!0,visible:!1}),this._attachmentUploader.addStyleClass(\"sasCMAttachmentUploaderIcon\"),this._attachmentUploader.attachFilesSelected(this._handleAttachmentFilesSelected,this),this._controlBar.addContent(this._attachmentUploader),this._submitButton=new sas.hc.m.Button(this.getId()+\"-submitButton\",{text:this.rb.getText(\"CommentEntryForm.Post.txt\"),enabled:!1}),this._submitButton.addStyleClass(\"sasPrimaryButton sasCMCommentSubmitButton\"),this._submitButton.attachPress(this._handleSubmitPress,this),this._controlBar.addContent(this._submitButton),this._cancelButton=new sas.hc.m.Button(this.getId()+\"-cancelButton\",{text:this.rb.getText(\"CommentEntryForm.Cancel.txt\"),enabled:!0}),this._cancelButton.addStyleClass(\"sasCMCommentCancelButton\"),this._cancelButton.attachPress(this._handleCancelPress,this),this._controlBar.addContent(this._cancelButton),this.addContent(this._controlBar)},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.setFormType=function(t){if(t&&this.getFormType()!==t)return this.setProperty(\"formType\",t,!0),t===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.TOPIC?this._commentText.setPlaceholder(this.rb.getText(\"CommentEntryForm.comment.placeholder.message.txt\")):t===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.COMMENT?this._commentText.setPlaceholder(this.rb.getText(\"CommentEntryForm.petrichor.comment.placeholder.message.txt\")):t===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.REPLY&&this._commentText.setPlaceholder(this.rb.getText(\"CommentEntryForm.petrichor.reply.placeholder.message.txt\")),t===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT?this.expandForm(!0):this.expandForm(!1),this},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.getCommentText=function(){return this._commentText?this._commentText.getValue():this.getProperty(\"commentText\")},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.setCommentText=function(t){if(this.getCommentText()!==t)return this.setProperty(\"commentText\",t),this._commentText&&this._commentText.setValue(t),this.getFormType()===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT&&this._cancelButton.setEnabled(!0),this},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.setShowAttachment=function(t){if(this.getProperty(\"showAttachment\")!==t)return this.setProperty(\"showAttachment\",t,!0),this._attachmentsContainer.setVisible(t),this._attachmentUploader.setVisible(t),this},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.setAttachments=function(t){return t||(t=[]),this.setProperty(\"attachments\",t,!0),this.getShowAttachment()?(this._attachmentsContainer.setVisible(!0),this._createAttachmentList(t)):this._attachmentsContainer.setVisible(!1),this},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._createAttachmentList=function(t){var e,s,n;for(s=this._attachmentList.getItems(),e=0;e<s.length;e++)s[e].destroy&&s[e].destroy();this._attachmentList.destroyItems(),this._attachmentsToDelete.splice(0,this._attachmentsToDelete.length),!t||t.length<=0||(n={data:this.getProperty(\"attachments\")},this._attachmentList.getModel().setData(n),this._attachmentList.getModel().refresh(!0))},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._handleTopicLiveChange=function(t){this.setTopicName(t.oSource.getValue()),\"\"!==String(t.oSource.getValue()).trim()&&(this.expandForm(!0),this.fireEnableOthers({isEnable:!1})),this._manageButtonsState()},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._handleCommentLiveChange=function(t){this.setCommentText(t.oSource.getValue()),\"\"!==String(t.oSource.getValue()).trim()&&(this.expandForm(!0),this.fireEnableOthers({isEnable:!1}),this.fireTextChanged({type:this.getFormType()})),this._isCommentTextChanged=!0,this.getModel(\"commentEntryFormModel\")&&this.getModel(\"commentEntryFormModel\").setProperty(\"/isTextChanged\",this._isCommentTextChanged),this._manageButtonsState()},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._handleAttachmentFilesSelected=function(t){var e,s,n,o,i=[],r=[],a=[],m=[],c=[],h=!1,l=this.rb.getText(\"Attachment.addAttachment.message.attachFiles.txt\"),d=this.rb.getText(\"Attachment.addAttachment.message.title.txt\");if(t.getSource().oFileUpload&&(s=t.getParameter(\"files\"),!(s.length<=0))){for(n=jQuery.proxy(function(t){(\"object\"==typeof t?t.getParameter(\"origin\").getText():t)===l&&this._attachmentsUpload(i)},this),o=jQuery.proxy(function(t){var e;(\"object\"==typeof t?t.getParameter(\"origin\").getText():t)===l&&(r.length>0?s.length===r.length?sas.hc.m.MessageDialog.error({text:this.rb.getText(\"Attachment.uploadContent.maxFileSizeexceeded.error.message.txt\"),title:d}):h?(e=this.rb.getText(\"Attachment.uploadContent.maxFileSizeLimitexceeded.error.message.fmt\",[\"\\n\\n\"+a.join(\"\\n\")+\"\\n\\n\"])+this.rb.getText(\"Attachment.uploadContent.questionToContinue.error.message.txt\"),sas.hc.m.MessageDialog.warning({text:e,title:d,buttonActions:[l,sas.hc.m.MessageDialogAction.Cancel],buttonPress:n})):sas.hc.m.MessageDialog.warning({text:this.rb.getText(\"Attachment.uploadContent.maxFileSizeLimitexceeded.error.message.fmt\",[\"\\n\\n\"+a.join(\"\\n\")]),title:d}):this._attachmentsUpload(i))},this),e=0;e<s.length;e++)s[e].value.size<=0?(m.push(s[e].value),c.push(s[e].value.name)):s[e].maxFileSizeExceeded?(r.push(s[e].value),a.push(s[e].value.name)):(h=!0,i.push(s[e].value));m.length>0?s.length===m.length?sas.hc.m.MessageDialog.error({text:this.rb.getText(\"Attachment.uploadContent.allEmptyFiles.error.message.txt\"),title:d}):sas.hc.m.MessageDialog.warning({text:this.rb.getText(\"Attachment.uploadContent.someEmptyFiles.error.message.fmt\",[\"\\n\\n\"+c.join(\"\\n\")+\"\\n\\n\"]),title:d,buttonActions:[l,sas.hc.m.MessageDialogAction.Cancel],buttonPress:o}):o(l)}},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._attachmentsUpload=function(e){var s,n,o,i,r,a,m,c=this.getAttachments(),h=[];for(s=0;s<e.length;s++)i=e[s].name,r=i.substring(i.lastIndexOf(\".\")).toLowerCase(),-1===t.indexOf(r)?(o=new sas.hc.ui.services.comment.petrichor.model.Attachment,o.fileRef=e[s],o.name=e[s].name,o.type=e[s].type,o.size=e[s].size,c.push(o)):(r=r.toUpperCase().substring(1),-1===h.indexOf(r)&&h.push(r));h.length>0&&(a=this.rb.getText(\"Attachment.restrictedFile.error.message.fmt\",[h.join(\", \")]),m=this.rb.getText(\"Attachment.addAttachment.message.title.txt\"),sas.hc.m.MessageDialog.error({text:a,title:m})),this._attachmentUploader.oBrowse.focus(),this.setProperty(\"attachments\",c),n={data:this.getProperty(\"attachments\")},this._attachmentList.getModel().setData(n),this._attachmentList.getModel().refresh(!0),this._attachmentsContainer.setVisible(!0),this._manageButtonsState()},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._handleRemoveAttachmentPress=function(t){var e,s,n,o;e=t.getParameter(\"listItem\"),s=this._attachmentList.getModel().getData(),n=e.getBindingContext().getObject(),o=s.data.indexOf(n),s.data.splice(o,1),this._attachmentList.getModel().refresh(),this.setProperty(\"attachments\",s.data),void 0===n.id&&isNaN(n.id)||(this._attachmentsToDelete.push(n),this._isExistingAttachmentRemoved=!0,this.getModel(\"commentEntryFormModel\")&&this.getModel(\"commentEntryFormModel\").setProperty(\"/deleteAttachments\",this._attachmentsToDelete)),this._attachmentList.removeItem(e),0===s.data.length&&(this._attachmentsContainer.setVisible(!1),this._attachmentUploader.oBrowse.focus()),this._manageButtonsState()},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._handleSubmitPress=function(t){var e,s,n,o={},i=!1;if(o=this._createSubmitData(),this.getShowAttachment()){for(e=this.getAttachments(),this._attachmentLoadCount=0,this._attachmentLoadErrorOccured=!1,this._filesNameOnWhichLoadErrorOccur=[],this._attachmentsToAdd.splice(0,this._attachmentsToAdd.length),n=0;n<e.length;n++)if(s=e[n],0!==s.id&&!s.id){var r=new FileReader;r.onload=jQuery.proxy(this._handleFileReaderOnload,this),r.onerror=jQuery.proxy(this._handleFileReaderOnerror,this),r.attachment=s,this._attachmentsToAdd.push(s),r.readAsArrayBuffer(s.fileRef),i=!0}i||(o.addAttachments=this._attachmentsToAdd,o.deleteAttachments=this._attachmentsToDelete,this.fireSubmitted(o,!1,!0),this.fireEnableOthers({isEnable:!0}))}else this.fireSubmitted(o),this.fireEnableOthers({isEnable:!0});this._submitButton.setEnabled(!1)},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._handleFileReaderOnload=function(t){var e,s=t.target.attachment;delete t.target.attachment,s.data=t.target.result,this._attachmentLoadCount++,this._attachmentLoadCount===this._attachmentsToAdd.length&&(this._attachmentLoadErrorOccured?this._showErrorMeaasgeForfilesDeletedOrRenamed():(e=this._createSubmitData(),e.addAttachments=this._attachmentsToAdd,e.deleteAttachments=this._attachmentsToDelete,this.fireSubmitted(e),this.fireEnableOthers({isEnable:!0}))),t.target.onload=void 0,t.target.onerror=void 0},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._showErrorMeaasgeForfilesDeletedOrRenamed=function(){var t,e,s,n=function(n){var o=this;if(\"Yes\"===n.getParameter(\"origin\").getMessageDialogAction()){for(this._filesNameOnWhichLoadErrorOccur.forEach(function(t,e){for(s=0;s<o._attachmentsToAdd.length;s++)t===o._attachmentsToAdd[s].fileRef.name&&(delete o._attachmentsToAdd[s].fileRef,o._attachmentsToAdd.splice(s,1))}),t=this._createSubmitData(),e=0;e<this._attachmentsToAdd.length;e++)this._attachmentsToAdd[e].fileRef&&delete this._attachmentsToAdd[e].fileRef;t.addAttachments=this._attachmentsToAdd,t.deleteAttachments=this._attachmentsToDelete,this.fireSubmitted(t),this.fireEnableOthers({isEnable:!0})}};sas.hc.m.MessageDialog.error({text:this.rb.getText(\"Attachment.uploadFile.error.messages.fmt\",[this._filesNameOnWhichLoadErrorOccur.join(\", \")]),title:this.rb.getText(\"Attachment.addAttachment.message.title.txt\"),buttonActions:[sas.hc.m.MessageDialogAction.Yes,sas.hc.m.MessageDialogAction.No],buttonPress:jQuery.proxy(n,this)})},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._handleFileReaderOnerror=function(t){var e=t.target.attachment.name;this._filesNameOnWhichLoadErrorOccur.push(e),this._attachmentLoadErrorOccured=!0,this._attachmentLoadCount++,this._attachmentLoadCount===this._attachmentsToAdd.length&&this._showErrorMeaasgeForfilesDeletedOrRenamed(),t.target.onload=void 0,t.target.onerror=void 0},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._createSubmitData=function(){var t={};return t.type=this.getFormType(),t.commentId=this.getCommentId(),t.commentText=this._commentText.getValue(),t.commentText&&(t.commentText=t.commentText.trim()),t.parentId=this.getParentId(),t.resourceUri=this.getResourceUri(),t.elementId=this.getElementId(),t.isTextChanged=this._isCommentTextChanged,t.modifiedTimeStamp=this.getModifiedTimeStamp(),t},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.clear=function(){var t;this._commentText.setValue(\"\"),this._attachmentList.destroyItems(),this.setAttachments([]),t={data:[]},this._attachmentList.getModel().setData(t),this._submitButton.setEnabled(!1),this._attachmentsToDelete.splice(0,this._attachmentsToDelete.length),this._isCommentTextChanged=!1,this.getModel(\"commentEntryFormModel\")&&this.getModel(\"commentEntryFormModel\").setProperty(\"/isTextChanged\",this._isCommentTextChanged),this._isExistingAttachmentRemoved=!1,this.expandForm(!1)},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._handleCancelPress=function(t){this.clear(),this.fireEnableOthers({isEnable:!0}),this.setInitialFocus(),this.fireCanceled({type:this.getFormType()})},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.setInitialFocus=function(){window.setTimeout(function(){this._commentText.focus(),this._commentText.selectText(this._commentText.getValue().length,this._commentText.getValue().length)}.bind(this),0)},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype._manageButtonsState=function(){var t,e,s,n=!1,o=!1,i=!1;if(this._commentText&&(\"\"!==String(this._commentText.getValue()).trim()&&(n=!0),o=!(!o&&!this._commentText.getValue())),this.getFormType()===sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT){if(this.getShowAttachment())for(t=this.getAttachments(),e=0;e<t.length;e++)if(s=t[e],0!==s.id&&!s.id){i=!0;break}this._submitButton.setEnabled(n&&(this._isCommentTextChanged||this._isExistingAttachmentRemoved||i))}else this._submitButton.setEnabled(n);this._cancelButton.setEnabled(this._cancelButton.getEnabled()||o)},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.expandForm=function(t){var e=this.getFormType();e!==sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.COMMENT&&e!==sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT&&e!==sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.REPLY||this._commentText.removeStyleClass(\"sasCMEntryFormDisplayNone\"),t?this._controlBar.removeStyleClass(\"sasCMEntryFormDisplayNone\"):this._controlBar.addStyleClass(\"sasCMEntryFormDisplayNone\"),this.getShowAttachment()&&(this._attachmentsContainer.setVisible(t),this._attachmentUploader.setVisible(t)),this._isExpanded!==t&&this._setCommentTextMaxHeight(),this._isExpanded=t},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.exit=function(){this._commentText.detachEvent(\"liveChange\",this._handleCommentLiveChange),this._commentText.destroy(),this._submitButton.detachEvent(\"press\",this._handleSubmitPress,this),this._submitButton.destroy(),this._cancelButton.detachEvent(\"press\",this._handleCancelPress,this),this._cancelButton.destroy(),this._attachmentUploader.destroy(),this._controlBar.destroy();var t,e=this._attachmentList.getItems();for(t=0;t<e.length;t++)e[t].destroy&&e[t].destroy();this._attachmentList.destroyItems(),this._attachmentList.unbindAggregation(\"items\"),this._attachmentList.getModel().destroy(),this._attachmentList.destroy(),this._attachmentUploader&&(this._attachmentUploader.detachFilesSelected(this._handleAttachmentFilesSelected,this),this._attachmentUploader.destroy())},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.setEnabled=function(t){this.setProperty(\"enabled\",t,!0);var e=this.getFormType();e!==sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.COMMENT&&e!==sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT&&e!==sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.REPLY||(t?(this._commentText.setEnabled(!0,!0),jQuery.sap.byId(this._commentText.getId()+\"-inner\").removeAttr(\"disabled\")):(this._commentText.setEnabled(!1,!0),jQuery.sap.byId(this._commentText.getId()+\"-inner\").attr(\"disabled\",\"disabled\")))},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.prototype.isFormExpanded=function(){return this._isExpanded}}(),sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.TOPIC=\"topicType\",sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.COMMENT=\"commentType\",sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.REPLY=\"replyType\",sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT=\"editType\",sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.TEXTAREARESIZED=\"textAreaResized\";",
	"sas/hc/ui/services/comment/petrichor/components/CommentEntryFormRenderer.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.components.CommentEntryFormRenderer\"),jQuery.sap.require(\"sap.ui.core.Renderer\"),jQuery.sap.require(\"sas.hc.ui.layout.VerticalLayoutRenderer\"),sas.hc.ui.services.comment.petrichor.components.CommentEntryFormRenderer=sap.ui.core.Renderer.extend(sas.hc.ui.layout.VerticalLayoutRenderer);",
	"sas/hc/ui/services/comment/petrichor/components/CommentListItem.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.components.CommentListItem\"),jQuery.sap.require(\"sap.ui.core.Core\"),jQuery.sap.require(\"sas.hc.ui.core.theme.IconInitialization\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentListItemRenderer\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentEntryForm\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentReplyForm\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil\"),jQuery.sap.require(\"sas.hc.m.ListItemBase\"),jQuery.sap.require(\"sas.hc.m.Text\"),jQuery.sap.require(\"sas.hc.m.Label\"),jQuery.sap.require(\"sas.hc.m.Link\"),jQuery.sap.require(\"sas.hc.ui.core.Icon\"),jQuery.sap.require(\"sas.hc.ui.layout.HorizontalLayout\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil\"),jQuery.sap.require(\"sas.hc.m.MessageDialog\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.Comment\"),jQuery.sap.require(\"sas.hc.ui.layout.VerticalLayout\"),jQuery.sap.require(\"sas.ltjs.sasicu.util.SASFormatterUtil\"),jQuery.sap.require(\"sap.ui.core.library\"),jQuery.sap.require(\"sap.m.library\"),jQuery.sap.require(\"sas.hc.m.library\"),jQuery.sap.require(\"sas.hc.m.Button\"),function(){\"use strict\";var e,t,s=sap.ui.requireSync(\"sap/ui/events/KeyCodes\");sas.ltjs.sasicu.util.SASFormatterUtil.instancePromise(\"COMMA\").then(function(e){t=e}),sas.hc.m.ListItemBase.extend(\"sas.hc.ui.services.comment.petrichor.components.CommentListItem\",{metadata:{properties:{userId:{type:\"string\",group:\"Appearance\",defaultValue:null},commentId:{type:\"string\",group:\"Behavior\",defaultValue:void 0},parentId:{type:\"string\",group:\"Behavior\",defaultValue:null},resourceUri:{type:\"string\",group:\"Behavior\",defaultValue:void 0},elementId:{type:\"string\",group:\"Behavior\",defaultValue:void 0},userName:{type:\"string\",group:\"Appearance\",defaultValue:null},date:{type:\"string\",group:\"Appearance\",defaultValue:null},modifiedDate:{type:\"string\",group:\"Appearance\",defaultValue:null},topicName:{type:\"string\",group:\"Appearance\",defaultValue:null},text:{type:\"string\",group:\"Appearance\",defaultValue:null},maxPreviewLines:{type:\"int\",group:\"Appearance\",defaultValue:5},showEdit:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},showDelete:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},enableEdit:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},enableDelete:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},readOnly:{type:\"boolean\",group:\"Misc\",defaultValue:!1},isSearchMode:{type:\"boolean\",group:\"Misc\",defaultValue:!1},searchString:{type:\"string\",group:\"Misc\",defaultValue:null},attachments:{type:\"object\",group:\"Behaviour\"},showAttachment:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},maxReplyDisplay:{type:\"int\",group:\"Appearance\",defaultValue:5},replyCount:{type:\"int\",group:\"Appearance\",defaultValue:void 0},commentListType:{type:\"string\",group:\"Behaviour\",defaultValue:void 0},isEditMode:{type:\"boolean\",group:\"Misc\",defaultValue:!1},showReplyEdit:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},showReplyDelete:{type:\"boolean\",group:\"Appearance\",defaultValue:!0}},aggregations:{usernameLabel:{type:\"sas.hc.m.Label\",multiple:!1,visibility:\"hidden\"},commentText:{type:\"sas.hc.m.Text\",multiple:!1,visibility:\"hidden\"},moreLink:{type:\"sas.hc.m.Link\",multiple:!1,visibility:\"hidden\"},editIcon:{type:\"sas.hc.m.Button\",multiple:!1,visibility:\"hidden\"},deleteIcon:{type:\"sas.hc.m.Button\",multiple:!1,visibility:\"hidden\"},attachmentContainer:{type:\"sas.hc.ui.layout.VerticalLayout\",multiple:!1,visibility:\"hidden\"},editForm:{type:\"sas.hc.ui.services.comment.petrichor.components.CommentEntryForm\",multiple:!1,visibility:\"hidden\"},replyForm:{type:\"sas.hc.ui.services.comment.petrichor.components.CommentReplyForm\",multiple:!1,visibility:\"hidden\"},replyEntryForm:{type:\"sas.hc.ui.services.comment.petrichor.components.CommentEntryForm\",multiple:!1,visibility:\"hidden\"},replyContainer:{type:\"sas.hc.ui.layout.HorizontalLayout\",multiple:!1,visibility:\"hidden\"}},events:{enableOthers:{enableEventBubbling:!0},deleteComment:{enableEventBubbling:!0},editComment:{enableEventBubbling:!0},preserveFocus:{enableEventBubbling:!0},openAttachment:{enableEventBubbling:!0},getReplies:{enableEventBubbling:!0},replyPress:{enableEventBubbling:!0}}},constructor:function(t,s,i){sas.hc.m.ListItemBase.apply(this,arguments),\"object\"==typeof t&&(i=s),!e&&i&&(e=i)},rb:sap.ui.getCore().getLibraryResourceBundle(\"sas.hc.ui.services.comment\"),renderer:\"sas.hc.ui.services.comment.petrichor.components.CommentListItemRenderer\"}),sas.hc.ui.services.comment.petrichor.components.CommentListItem.M_EVENTS={enableOthers:\"enableOthers\",deleteComment:\"deleteComment\",editComment:\"editComment\",preserveFocus:\"preserveFocus\",openAttachment:\"openAttachment\",getReplies:\"getReplies\",replyPress:\"replyPress\"},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.init=function(){this._hasWriteAccess=!0,sas.hc.m.ListItemBase.prototype.init.apply(this);var e,s,i,o,n,r,a,m=this;e=new sas.hc.m.Text(this.getId()+\"-commentTxt\",{maxLines:this.getMaxPreviewLines(),width:\"100%\"}).addStyleClass(\"sasCMCommentText\"),this.setAggregation(\"commentText\",e),s=new sas.hc.m.Link(this.getId()+\"-commentMTLink\",{text:this.rb.getText(\"CommentListItem.moreTextLink.ShowMore.txt\"),press:jQuery.proxy(this._handleMoreTextPress,this)}).addStyleClass(\"sasCMCommentMTLink sasUiSmallLink\"),this.setAggregation(\"moreLink\",s),i=new sas.hc.ui.layout.VerticalLayout(this.getId()+\"-attachmentContainer\",{visible:!0}).addStyleClass(\"sasCMCommentAttchmentContainer\"),this.setAggregation(\"attachmentContainer\",i),r=new sas.hc.m.Button(this.getId()+\"-commentReplyLink\",{text:this.rb.getText(\"CommentReplyForm.replyLink.txt\"),design:sas.hc.m.Button.Design.SmallLightWeightNeutral,visible:{parts:[{path:\"parentId\"},{path:\"isReadOnly\"}],formatter:jQuery.proxy(function(e,t){return!!this._hasWriteAccess&&(!!e||!t)},this)},press:jQuery.proxy(this._handleReplyPress,this)}).addStyleClass(\"sasCMCommentReplyLink sasUiSmallLink\"),a=new sas.hc.m.Button(this.getId()+\"-commentReplyCountBtn\",{text:{parts:[{path:\"childCount\"},{path:\"searchCount\"},{path:\"isReplyExpanded\"}],formatter:function(e,s,i){if(e){var o,n;return this.removeStyleClass(\"sasCMHighlight\"),s&&!i&&this.addStyleClass(\"sasCMHighlight\"),t?(o=t.format(e),s?(n=t.format(s),m.rb.getText(\"CommentReplyForm.replyCount.search.fmt\",[n,o])):\"(\"+o+\")\"):s?m.rb.getText(\"CommentReplyForm.replyCount.search.fmt\",[s,e]):\"(\"+e+\")\"}}},visible:{path:\"childCount\",formatter:function(e){return!!(e&&e>0)}},ariaLabel:{parts:[{path:\"childCount\"},{path:\"isReplyExpanded\"}],formatter:jQuery.proxy(function(e,t){return t?this.rb.getText(\"CommentReplyForm.replyCount.hideReplyButton.ariaLabel.fmt\",[e]):this.rb.getText(\"CommentReplyForm.replyCount.showReplyButton.ariaLabel.fmt\",[e])},this)},icon:sas.icons.HC.COMMENTINDICATOR,press:jQuery.proxy(this._handleReplyCountPress,this),tooltip:{path:\"isReplyExpanded\",formatter:jQuery.proxy(function(e){return e?this.rb.getText(\"CommentReplyForm.replyCount.hideReplyButton.txt\"):this.rb.getText(\"CommentReplyForm.replyCount.showReplyButton.txt\")},this)}}).addStyleClass(\"sasCMCommentReplyCount\"),o=new sas.hc.ui.layout.HorizontalLayout(this.getId()+\"-replyLinkCountContainer\",{visible:{path:\"parentId\",formatter:function(e){return!e}},content:[r,a]}).addStyleClass(\"sasCMCommentReplyContainer\"),this.setAggregation(\"replyContainer\",o),n=new sas.hc.ui.services.comment.petrichor.components.CommentEntryForm(this.getId()+\"-replyEntry\",{width:\"100%\",resourceUri:\"{resourceUri}\",elementId:\"{elementId}\",commentId:\"{id}\",parentId:\"{parentId}\",visible:\"{showReplyTextbox}\",showAttachment:this.getShowAttachment()},sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.REPLY).addStyleClass(\"sasCMEntryForm sasCMReplyEntryForm\"),this.setAggregation(\"replyEntryForm\",n),this._sResizeListenerId=null,this._isEditMode=!1},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleReplyPress=function(e){for(var t=this.getModel().getData().children,s=this.getAggregation(\"replyEntryForm\"),i=0;i<t.length;i++)this.getCommentId()===t[i].id&&(t[i].showReplyTextbox?t[i].showReplyTextbox=!1:t[i].showReplyTextbox=!0);this.getModel().refresh(),window.setTimeout(function(){s.clear(),s.setInitialFocus()}.bind(this),0),this.fireReplyPress()},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleReplyCountPress=function(e){var t=this.getAggregation(\"replyForm\");t.getVisible()?(t.setVisible(!1),this.getAggregation(\"replyContainer\").removeStyleClass(\"sasCMReplyListExpanded\"),this.fireGetReplies()):(this.getAggregation(\"replyContainer\").addStyleClass(\"sasCMReplyListExpanded\"),this.fireGetReplies({parentId:this.getCommentId(),resourceUri:this.getResourceUri(),elementId:this.getElementId()}))},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.applySettings=function(t){var s=new sas.hc.ui.services.comment.petrichor.components.CommentReplyForm(this.getId()+\"-commentReplyForm\",{visible:\"{isReplyExpanded}\",resourceUri:\"{resourceUri}\",elementId:\"{elementId}\",commentId:\"{id}\",parentId:\"{parentId}\",readOnly:\"{isReadOnly}\",showEdit:this.getShowReplyEdit(),showDelete:this.getShowReplyDelete()},e);this.setAggregation(\"replyForm\",s),sas.hc.m.ListItemBase.prototype.applySettings&&sas.hc.m.ListItemBase.prototype.applySettings.apply(this,arguments);var i=this.getCommentText(),o=this.getAggregation(\"editIcon\"),n=this.getAggregation(\"deleteIcon\"),s=this.getAggregation(\"replyForm\");i.setMaxLines(this.getMaxPreviewLines()),this.getShowEdit()&&!o&&(o=this._getEditIcon(),this.setAggregation(\"editIcon\",o)),this.getShowDelete()&&!n&&(n=this._getDeleteIcon(),this.setAggregation(\"deleteIcon\",n)),s&&s.setMaxPreviewLines(this.getMaxPreviewLines());var r=new sas.hc.m.Label(this.getId()+\"-userName\",{text:this.getUserName()}).addStyleClass(\"sasCMUserName\");this.setAggregation(\"usernameLabel\",r)},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.onBeforeRendering=function(){var t=this.getAggregation(\"editIcon\"),s=this.getAggregation(\"deleteIcon\"),i=this.getAggregation(\"attachmentContainer\"),o=this.getAggregation(\"usernameLabel\");t&&(t.setEnabled(this.getEnableEdit()),t.setVisible(!(this.getReadOnly()||!this.getShowEdit()))),s&&(s.setEnabled(this.getEnableDelete()),s.setVisible(!(this.getReadOnly()||!this.getShowDelete()))),o&&o.setText(this.getUserName());var n=this.getAttachments();if(i.destroyContent(),this.getShowAttachment()&&n&&n.length>0&&!this._isEditMode)for(var r=0;r<n.length;r++){var a=n[r],m=a.name.substring(a.name.lastIndexOf(\".\"),a.name.length);-1===e.indexOf(m.toLowerCase())&&(i.addContent(this._createLinkItem(this.getId()+\"-attachLink-\"+r,a)),i.setVisible(!0))}else i.setVisible(!1)},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._getEditIcon=function(){var e=new sas.hc.m.Button(this.getId()+\"-editIcon\",{tooltip:this.rb.getText(\"CommentListItem.editIcon.tooltip.txt\"),icon:sas.icons.HC.EDIT,ariaLabel:this.rb.getText(\"CommentListItem.editIcon.ariaLabel.txt\")});return this.getCommentListType()===sas.hc.ui.services.comment.petrichor.components.CommentListItem.REPLY&&e.setAriaLabel(this.rb.getText(\"CommentListItem.editIconReply.ariaLabel.txt\")),e.addStyleClass(\"sasCMEditIcon\"),e.attachPress(this._handleEditPress,this),e},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._getDeleteIcon=function(){var e=new sas.hc.m.Button(this.getId()+\"-deleteIcon\",{tooltip:this.rb.getText(\"CommentListItem.deleteIcon.tooltip.txt\"),icon:sas.icons.HC.DELETE,ariaLabel:this.rb.getText(\"CommentListItem.deleteIcon.ariaLabel.txt\")});return this.getCommentListType()===sas.hc.ui.services.comment.petrichor.components.CommentListItem.REPLY&&e.setAriaLabel(this.rb.getText(\"CommentListItem.deleteIconReply.ariaLabel.txt\")),e.addStyleClass(\"sasCMDeleteIcon\"),e.attachPress(this._handleDeletePress,this),e},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setShowEdit=function(e){this.setProperty(\"showEdit\",e);var t=this.getAggregation(\"editIcon\");return t||(t=this._getEditIcon(),this.setAggregation(\"editIcon\",t)),t.setVisible(!(this.getReadOnly()||!e)),this},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setShowReplyEdit=function(e){this.setProperty(\"showReplyEdit\",e,!0),this.getAggregation(\"replyForm\").setShowEdit(e)},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setShowDelete=function(e){this.setProperty(\"showDelete\",e);var t=this.getAggregation(\"deleteIcon\");return t||(t=this._getDeleteIcon(),this.setAggregation(\"deleteIcon\",t)),t.setVisible(!(this.getReadOnly()||!e)),this},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setShowReplyDelete=function(e){this.setProperty(\"showReplyDelete\",e,!0),this.getAggregation(\"replyForm\").setShowDelete(e)},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setMaxPreviewLines=function(e){return this.setProperty(\"maxPreviewLines\",e),this.getAggregation(\"replyForm\").setMaxPreviewLines(e),this},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleAttachLinkPress=function(e){var t=e.oSource.data(\"attachment\"),s=e.oSource.data(\"commentId\");this.fireOpenAttachment({commentId:s,attachment:t})},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setReadOnly=function(e){if(this.getReadOnly()!==e){if(this.setProperty(\"readOnly\",e),e)this._handleEditCanceledInternal();else if(this._isEditMode){var t=this.getAggregation(\"editForm\");this.getCommentText().setVisible(!1),this.getAggregation(\"moreLink\").setVisible(!1),this.getAggregation(\"editIcon\").setEnabled(!1),t.setVisible(!0),this.fireEnableOthers({isEnable:!1})}var s=this.getAggregation(\"editIcon\"),i=this.getAggregation(\"deleteIcon\"),o=this.getAggregation(\"replyForm\");s&&s.setVisible(!(e||!this.getShowEdit())),i&&i.setVisible(!(e||!this.getShowDelete())),o&&o.setReadOnly(e)}},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleKeyDown=function(e){e.keyCode===s.SPACE&&e.target.id===this.getId()+\"-commentMTLink\"&&e.preventDefault()},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.onAfterRendering=function(){var e,t,s=this.getAggregation(\"replyContainer\");this._displayShowMoreLink(),e=this.getSearchString(),t=this.getText().toLocaleLowerCase(),e&&this.getIsSearchMode()&&-1!==t.indexOf(e)&&sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil.hightlightSearchedString(e,this.getCommentText().getId()),this.$(\"commentMTLink\").bind(\"keydown\",jQuery.proxy(this._handleKeyDown,this)),s&&s.getContent()[0].$().attr(\"draggable\",!1)},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._displayShowMoreLink=function(){var e,t,s,i;e=this.getCommentText(),t=this.getAggregation(\"moreLink\"),e&&t&&(i=e.getTextDomRef(),s=t.$(),i&&s&&(!this.getIsSearchMode()&&this.getMaxPreviewLines()>0&&i.scrollHeight>=e.getLineHeight()*(this.getMaxPreviewLines()+1)?s.css(\"display\").indexOf(\"inline\")<0?(s.css(\"display\",\"inline\"),i.scrollHeight>i.clientHeight?(t.setText(this.rb.getText(\"CommentListItem.moreTextLink.ShowMore.txt\")),e.setMaxLines(this.getMaxPreviewLines())):(t.setText(this.rb.getText(\"CommentListItem.moreTextLink.ShowLess.txt\")),e.setMaxLines(1e3))):(t.setText(this.rb.getText(\"CommentListItem.moreTextLink.ShowMore.txt\")),e.setMaxLines(this.getMaxPreviewLines())):(s.css(\"display\",\"none\"),e.setMaxLines(1e3))))},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setIsSearchMode=function(e){this.setProperty(\"isSearchMode\",e,!0);var t=this.getAggregation(\"replyForm\");t&&t.setIsSearchMode(e)},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleMoreTextPress=function(){var e=this.getAggregation(\"moreLink\");e.getText()===this.rb.getText(\"CommentListItem.moreTextLink.ShowMore.txt\")?(e.setText(this.rb.getText(\"CommentListItem.moreTextLink.ShowLess.txt\")),this.getCommentText().setMaxLines(1e3)):(e.setText(this.rb.getText(\"CommentListItem.moreTextLink.ShowMore.txt\")),this.getCommentText().setMaxLines(this.getMaxPreviewLines()))},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setText=function(e){return this.setProperty(\"text\",e,!0),this.getCommentText()&&this.getCommentText().setText(e),this},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.getCommentText=function(){return this.getAggregation(\"commentText\")},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setEnableEdit=function(e){this.setProperty(\"enableEdit\",e,!0);var t=this.getAggregation(\"editIcon\");return t&&(t.setEnabled(e,!0),this.getDomRef()&&(e?(t.removeStyleClass(\"sapMBtnDisabled\"),t.getDomRef()&&jQuery(t.getDomRef()).removeAttr(\"disabled\")):(t.addStyleClass(\"sapMBtnDisabled\"),t.getDomRef()&&jQuery(t.getDomRef()).attr(\"disabled\",\"disabled\")))),this},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setEnableDelete=function(e){this.setProperty(\"enableDelete\",e,!0);var t=this.getAggregation(\"deleteIcon\");return t&&(t.setEnabled(e,!0),this.getDomRef()&&(e?(t.removeStyleClass(\"sapMBtnDisabled\"),t.getDomRef()&&jQuery(t.getDomRef()).removeAttr(\"disabled\")):(t.addStyleClass(\"sapMBtnDisabled\"),t.getDomRef()&&jQuery(t.getDomRef()).attr(\"disabled\",\"disabled\")))),this},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._enableReplyInteractions=function(e,t){var s=this.getAggregation(\"replyForm\"),i=this.getAggregation(\"replyEntryForm\"),o=this.getAggregation(\"replyContainer\");if(o)for(var n=o.getContent(),r=0;r<n.length;r++)n[r].setEnabled(e);i!==t&&i.setEnabled(e),s&&s._enableReplyInteractions(e,t)},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleCommentManagerResize=function(){this._displayShowMoreLink()},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleEditPress=function(){this._isEditMode=!0;var e=this.getAggregation(\"editForm\");this.getCommentText().setVisible(!1),this.getAggregation(\"moreLink\").setVisible(!1),this.getAggregation(\"editIcon\").setEnabled(!1),this.getAggregation(\"attachmentContainer\").setVisible(!1),e||(e=new sas.hc.ui.services.comment.petrichor.components.CommentEntryForm(this.getId()+\"-editForm\",{formType:sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.EDIT}),e.addStyleClass(\"sasCommentEditForm\"),e.attachCanceled(this._handleEditCanceled,this),this.setAggregation(\"editForm\",e)),e.setShowAttachment(this.getShowAttachment()),this.getShowAttachment()&&e.setAttachments(this.getAttachments()),e.setResourceUri(this.getResourceUri()),e.setElementId(this.getElementId()),e.setCommentId(this.getCommentId()),e.setParentId(this.getParentId()),e.setTopicName(this.getTopicName()),e.setCommentText(this.getText()),e.setModifiedTimeStamp(this.getModifiedDate()),e.expandForm(!0),e.setVisible(!0),this.invalidate(),e.setInitialFocus(),this.fireEnableOthers({isEnable:!1}),this.fireEditComment()},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleEditCanceled=function(e){this._isEditMode=!1,this._handleEditCanceledInternal()},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleEditCanceledInternal=function(){var e=this.getAggregation(\"editForm\"),t=this.getAggregation(\"editIcon\"),s=this.getAggregation(\"deleteIcon\"),i=this.getAggregation(\"attachmentContainer\");e&&e.setVisible(!1),this.getCommentText().setVisible(!0),this.getAggregation(\"moreLink\").setVisible(!0),i&&i.setVisible(!0),s&&s.setEnabled(!0),this.invalidate(),t&&(t.setEnabled(!0),this.getAggregation(\"editIcon\").focus())},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleDeletePress=function(){this.fireDeleteComment();var e=this.rb.getText(\"CommentManager.petrichor.delete.comment.message.txt\"),t=this.rb.getText(\"CommentManager.delete.message.title.txt\");this.getCommentListType()===sas.hc.ui.services.comment.petrichor.components.CommentListItem.REPLY&&(e=this.rb.getText(\"CommentManager.reply.delete.comment.message.txt\"),t=this.rb.getText(\"CommentManager.reply.delete.message.title.txt\")),sas.hc.m.MessageDialog.warning({text:e,title:t,buttonActions:[sas.hc.m.MessageDialogAction.Delete,{text:sas.hc.m.MessageDialogAction.Cancel,initialFocus:!0,defaultButton:!0}],buttonPress:jQuery.proxy(this._handleDeleteAction,this)})},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleDeleteAction=function(e){var t;switch(e.getParameter(\"origin\").getMessageDialogAction()){case sas.hc.m.MessageDialogAction.Delete:t=new sas.hc.ui.services.comment.petrichor.model.Comment,t.resourceUri=this.getResourceUri(),t.elementId=this.getElementId(),t.id=this.getCommentId(),t.author=this.getUserId(),t.authorDisplayName=this.getUserName(),t.createdOn=this.getDate(),t.parentId=this.getParentId(),t.subject=this.getTopicName(),t.text=this.getText(),this.firePreserveFocus({commentId:t.id}),this.fireDeleteComment({comment:t});break;case sas.hc.m.MessageDialogAction.Cancel:}},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._createLinkItem=function(e,t){var s,i,o,n,r;return s=new sas.hc.ui.layout.HorizontalLayout(e+\"-hLayout\",{}),s.addStyleClass(\"sasCMAttachmentLinkHolder\"),i=new String(t.name),o=i.toLowerCase().substring(i.lastIndexOf(\".\")),n=new sas.hc.ui.core.Icon(e+\"-icon\",{src:sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil.getFileTypeIcon(o)}),s.addContent(n),r=new sas.hc.m.Link(e+\"-attachmentLink\",{text:i,textDirection:sap.ui.core.TextDirection.LTR,press:jQuery.proxy(this._handleAttachLinkPress,this)}),r.data(\"attachment\",t),r.data(\"commentId\",this.getCommentId()),r.addStyleClass(\"sasCMAttachmentLink\"),s.addContent(r),s},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setIsEditMode=function(e){this.setProperty(\"isEditMode\",e),e||this._handleEditCanceled()},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.exit=function(){sas.hc.m.ListItemBase.prototype.exit&&sas.hc.m.ListItemBase.prototype.exit.apply(this,arguments);var e=this.getAggregation(\"usernameLabel\"),t=this.getAggregation(\"commentText\"),s=this.getAggregation(\"moreLink\"),i=this.getAggregation(\"editIcon\"),o=this.getAggregation(\"deleteIcon\"),n=this.getAggregation(\"editForm\"),r=this.getAggregation(\"attachmentContainer\"),a=this.getAggregation(\"replyForm\"),m=this.getAggregation(\"replyEntryForm\"),c=this.getAggregation(\"replyContainer\");e&&e.destroy(),t&&t.destroy(),s&&s.destroy(),i&&(i.detachPress(this._handleEditPress,this),i.destroy()),o&&(o.detachPress(this._handleDeletePress,this),o.destroy()),n&&(n.detachCanceled(this._handleEditCanceled,this),n.destroy()),r&&r.destroy(),a&&a.destroy(),m&&m.destroy(),c&&c.destroy()},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype.setShowAttachment=function(e){this.setProperty(\"showAttachment\",e),this.getAggregation(\"replyForm\").setShowAttachment(e),this.getAggregation(\"replyEntryForm\").setShowAttachment(e);var t=this.getAggregation(\"editForm\");t&&t.setShowAttachment(e)},sas.hc.ui.services.comment.petrichor.components.CommentListItem.prototype._handleUserWriteAccess=function(e){this._hasWriteAccess=e;var t=this.getAggregation(\"replyContainer\");t&&t.getContent()[0].setVisible(e&&!this.getReadOnly())},sas.hc.ui.services.comment.petrichor.components.CommentListItem.COMMENT=\"comment\",sas.hc.ui.services.comment.petrichor.components.CommentListItem.REPLY=\"reply\"}();",
	"sas/hc/ui/services/comment/petrichor/components/CommentListItemRenderer.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.components.CommentListItemRenderer\"),jQuery.sap.require(\"sap.ui.core.Renderer\"),jQuery.sap.require(\"sas.hc.m.ListItemBaseRenderer\"),sas.hc.ui.services.comment.petrichor.components.CommentListItemRenderer=sap.ui.core.Renderer.extend(sas.hc.m.ListItemBaseRenderer),sas.hc.ui.services.comment.petrichor.components.CommentListItemRenderer.renderLIContent=function(e,r){\"use strict\";var t,i,s,a,n,o,d;if(e.write(\"<div style='width: 100%' \"),e.writeControlData(r),e.write(\">\"),r.getVisible()){e.write(\"<div\"),e.addClass(\"sasCMNameEditDeleteContainer\"),e.writeClasses(),e.write(\">\"),e.write(\"<div\"),e.addClass(\"sasCMNameContainer\"),e.writeClasses(),e.write(\">\"),r.getUserName()&&e.renderControl(r.getAggregation(\"usernameLabel\")),e.write(\"</div>\"),e.write(\"<div\"),e.addClass(\"sasCMEditDeleteContainer\"),e.writeClasses(),e.write(\">\");var C=r.getAggregation(\"editIcon\");C&&e.renderControl(C);var g=r.getAggregation(\"deleteIcon\");g&&e.renderControl(g),e.write(\"</div>\"),e.write(\"</div>\"),t=r.getAggregation(\"commentText\"),t&&t.getVisible()&&e.renderControl(t),i=r.getAggregation(\"editForm\"),i&&i.getVisible()&&e.renderControl(i),s=r.getAggregation(\"moreLink\"),s&&(e.write(\"<div\"),e.addClass(\"sasCMCommentMTLinkWrapper\"),e.writeClasses(),e.write(\">\"),e.renderControl(s),e.write(\"</div>\")),e.write(\"<div\"),e.addClass(\"sasCMDateContainer\"),e.writeClasses(),e.write(\">\"),r.getDate()&&(e.write(\"<div\"),e.addClass(\"sasCMDate\"),e.writeClasses(),e.writeAttribute(\"id\",r.getId()+\"-date\"),e.write(\">\"),e.write(\"<span>\"),e.writeEscaped(r.getDate()),e.write(\"</span>\"),e.write(\"</div>\")),e.write(\"</div>\"),a=r.getAggregation(\"attachmentContainer\"),a.getVisible()&&e.renderControl(a),o=r.getAggregation(\"replyContainer\"),o&&(e.write(\"<div\"),e.addClass(\"sasCMCommentReplyContainerWrapper\"),e.writeClasses(),e.write(\">\"),e.renderControl(o),e.write(\"</div>\")),d=r.getAggregation(\"replyEntryForm\"),d&&(e.write(\"<div\"),e.addClass(\"sasCMCommentReplyEntryFormWrapper\"),e.writeClasses(),e.write(\">\"),e.renderControl(d),e.write(\"</div>\")),n=r.getAggregation(\"replyForm\"),n&&(e.write(\"<div\"),e.addClass(\"sasCMCommentReplyFormWrapper\"),e.writeClasses(),e.write(\">\"),e.renderControl(n),e.write(\"</div>\"))}e.write(\"</div>\")};",
	"sas/hc/ui/services/comment/petrichor/components/CommentReplyForm.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.components.CommentReplyForm\"),jQuery.sap.require(\"sap.ui.core.Core\"),jQuery.sap.require(\"sap.ui.model.BindingMode\"),jQuery.sap.require(\"sas.hc.m.List\"),jQuery.sap.require(\"sas.hc.ui.layout.VerticalLayout\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentEntryForm\"),jQuery.sap.require(\"sas.ltjs.sasicu.util.SASFormatterUtil\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentListItem\"),jQuery.sap.require(\"sap.ui.core.format.DateFormat\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.components.CommentListItem\"),jQuery.sap.require(\"sap.m.library\"),jQuery.sap.require(\"sas.hc.m.Link\"),jQuery.sap.require(\"sas.hc.ui.layout.HorizontalLayout\"),jQuery.sap.require(\"sas.hc.ui.core.util.CalendarUtil\"),function(){\"use strict\";var e,t;sas.ltjs.sasicu.util.SASFormatterUtil.instancePromise(\"DATETIME15\").then(function(e){t=e}),sas.hc.ui.layout.VerticalLayout.extend(\"sas.hc.ui.services.comment.petrichor.components.CommentReplyForm\",{metadata:{properties:{resourceUri:{type:\"string\",group:\"Behavior\",defaultValue:void 0},elementId:{type:\"string\",group:\"Behavior\",defaultValue:void 0},commentId:{type:\"string\",group:\"Behavior\",defaultValue:void 0},parentId:{type:\"string\",group:\"Behavior\",defaultValue:null},maxReplyDisply:{type:\"int\",group:\"Appearance\",defaultValue:5},readOnly:{type:\"boolean\",group:\"Misc\",defaultValue:!1},maxPreviewLines:{type:\"int\",group:\"Appearance\",defaultValue:5},showEdit:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},showDelete:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},showAttachment:{type:\"boolean\",group:\"Appearance\",defaultValue:!0},isSearchMode:{type:\"boolean\",group:\"Misc\",defaultValue:!1}},events:{showMoreReplies:{enableEventBubbling:!0},showAllReplies:{enableEventBubbling:!0},replyListUpdated:{enableEventBubbling:!0}}},constructor:function(t,s,o){sas.hc.ui.layout.VerticalLayout.apply(this,arguments),!e&&o&&(e=o)},rb:sap.ui.getCore().getLibraryResourceBundle(\"sas.hc.ui.services.comment\"),renderer:\"sas.hc.ui.services.comment.petrichor.components.CommentReplyFormRenderer\"}),sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.M_EVENTS={showMoreReplies:\"showMoreReplies\",showAllReplies:\"showAllReplies\",replyListUpdated:\"replyListUpdated\"},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype.exit=function(){sas.hc.ui.layout.VerticalLayout.prototype.exit&&sas.hc.ui.layout.VerticalLayout.prototype.exit.apply(this,arguments),this._replyList&&(this._replyList.destroy(),this._replyList=null),this._showMoreReplies&&(this._showMoreReplies.destroy(),this._showMoreReplies=null),this._showAllReplies&&(this._showAllReplies.destroy(),this._showAllReplies=null),this._hLayout&&(this._hLayout.destroy(),this._hLayout=null)},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype.applySettings=function(s,o){sas.hc.ui.layout.VerticalLayout.prototype.applySettings&&sas.hc.ui.layout.VerticalLayout.prototype.applySettings.apply(this,arguments),this._replyList=new sas.hc.m.List(this.getId()+\"-commentReplyList\",{mode:sap.m.ListMode.None,items:{path:\"replies/children\",factory:jQuery.proxy(function(s,o){var i=new sas.hc.ui.services.comment.petrichor.components.CommentListItem(s+\"-commentReplyListItem\",{userId:\"{author}\",resourceUri:\"{resourceUri}\",elementId:\"{elementId}\",commentId:\"{id}\",parentId:\"{parentId}\",topicName:\"{subject}\",userName:\"{authorDisplayName}\",date:{path:\"createdOn\",formatter:function(e){var s=new Date(e);return t?t.format(sas.hc.ui.core.util.CalendarUtil.jsDateToSASDateTime(s)):sap.ui.core.format.DateFormat.getDateTimeInstance({style:\"medium\"}).format(s)}},modifiedDate:\"{modifiedTimeStamp}\",text:\"{text}\",attachments:\"{attachments}\",isEditMode:\"{isEditMode}\",showEdit:{path:\"isEditable\",formatter:jQuery.proxy(this._hasEditCapable,this),mode:sap.ui.model.BindingMode.OneWay},showDelete:{path:\"isDeletable\",formatter:jQuery.proxy(this._hasDeleteCapable,this),mode:sap.ui.model.BindingMode.OneWay},readOnly:\"{isReadOnly}\",maxPreviewLines:this.getMaxPreviewLines(),showAttachment:this.getShowAttachment(),isSearchMode:this.getIsSearchMode(),commentListType:sas.hc.ui.services.comment.petrichor.components.CommentListItem.REPLY},e);return i.addStyleClass(\"sasCMCommentListItem sasCMCommentReplyListItem\"),i},this)},showNoData:!1}).addStyleClass(\"sasCMCommentList sasCMCommentReplyList\"),this._replyList.allowTextSelection(!0),this._replyList.attachUpdateFinished(this._handleReplyListUpdated,this),this.addContent(this._replyList),this._showMoreReplies=new sas.hc.m.Link(this.getId()+\"-showMoreReplies\",{text:{path:\"searchCount\",formatter:jQuery.proxy(function(e){return e?this.rb.getText(\"CommentReplyForm.showMoreLink.search.txt\"):this.rb.getText(\"CommentReplyForm.showMoreLink.txt\")},this)},visible:{path:\"replies\",formatter:function(e){return!!(e&&e.children.length<e.count)}},press:jQuery.proxy(this._handleShowMoreReplies,this)}).addStyleClass(\"sasCMShowMoreReplies sasUiSmallLink\"),this._showAllReplies=new sas.hc.m.Link(this.getId()+\"-showAllReplies\",{text:this.rb.getText(\"CommentReplyForm.showAllLink.txt\"),visible:{parts:[{path:\"replies\"},{path:\"searchCount\"},{path:\"childCount\"}],formatter:function(e,t,s){return!!(e&&e.children.length<s&&t&&t>0)}},press:jQuery.proxy(this._handleShowAllReplies,this)}).addStyleClass(\"sasCMShowAllReplies sasUiSmallLink\"),this._hLayout=new sas.hc.ui.layout.HorizontalLayout(this.getId()+\"-hLayout\",{visible:{parts:[{path:\"replies\"},{path:\"childCount\"}],formatter:function(e,t){return!!(e&&e.children.length<t)}},content:[this._showMoreReplies,this._showAllReplies]}).addStyleClass(\"sasCMReplyHLayout\"),this.addContent(this._hLayout),this.attachEvent(sas.hc.ui.services.comment.petrichor.components.CommentEntryForm.M_EVENTS.textAreaFocused,this._handleCommentTextAreaFocused,this)},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype._hasEditCapable=function(e){return!(!this.getShowEdit()||!e)},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype._hasDeleteCapable=function(e){return!(!this.getShowDelete()||!e)},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype.setShowEdit=function(e){if(this.setProperty(\"showEdit\",e,!0),this._replyList){var t,s,o=this._replyList.getItems();for(s=0;s<o.length;s++)t=o[s],t.setShowEdit(e)}return this},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype.setShowDelete=function(e){if(this.setProperty(\"showDelete\",e,!0),this._replyList){var t,s,o=this._replyList.getItems();for(s=0;s<o.length;s++)t=o[s],t.setShowDelete(e)}return this},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype.setShowAttachment=function(e){var t,s,o=this._replyList.getItems();for(s=0;s<o.length;s++)t=o[s],t.setShowAttachment(e);return this.setProperty(\"showAttachment\",e,!0),this},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype._handleCommentTextAreaFocused=function(e){e.getParameter(\"focused\")?this._replyList.setKeyboardMode(sap.m.ListKeyboardMode.Edit):this._replyList.setKeyboardMode(sap.m.ListKeyboardMode.Navigation)},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype._handleShowMoreReplies=function(e){this.fireShowMoreReplies({parentId:this.getCommentId(),resourceUri:this.getResourceUri(),elementId:this.getElementId()})},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype._handleShowAllReplies=function(e){this.fireShowAllReplies({parentId:this.getCommentId(),resourceUri:this.getResourceUri(),elementId:this.getElementId()})},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype._handleReplyListUpdated=function(e){this.fireReplyListUpdated({commentId:this.getCommentId(),replyList:this._replyList})},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype._enableReplyInteractions=function(e,t){for(var s,o=this._replyList.getItems(),i=0;i<o.length;i++)s=o[i],s.setEnableEdit(e),s.setEnableDelete(e),s._enableReplyInteractions(e,t);return this._showMoreReplies&&this._showMoreReplies.setEnabled(e),this._showAllReplies&&this._showAllReplies.setEnabled(e),this},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype.getReplyList=function(){return this._replyList},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype.setMaxPreviewLines=function(e){this.setProperty(\"maxPreviewLines\",e,!0);for(var t=this._replyList.getItems(),s=0;s<t.length;s++){t[s].setMaxPreviewLines(e)}return this},sas.hc.ui.services.comment.petrichor.components.CommentReplyForm.prototype.setIsSearchMode=function(e){this.setProperty(\"isSearchMode\",e,!0);for(var t=this._replyList.getItems(),s=0;s<t.length;s++){t[s].setIsSearchMode(e)}return this}}();",
	"sas/hc/ui/services/comment/petrichor/components/CommentReplyFormRenderer.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.components.CommentReplyFormRenderer\"),jQuery.sap.require(\"sap.ui.core.Renderer\"),jQuery.sap.require(\"sas.hc.ui.layout.VerticalLayoutRenderer\"),sas.hc.ui.services.comment.petrichor.components.CommentReplyFormRenderer=sap.ui.core.Renderer.extend(sas.hc.ui.layout.VerticalLayoutRenderer);",
	"sas/hc/ui/services/comment/petrichor/controller/CommentManagerController.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.controller.CommentManagerController\"),jQuery.sap.require(\"sap.ui.core.Core\"),jQuery.sap.require(\"sas.hc.ui.core.Core\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.Comment\"),jQuery.sap.require(\"sas.hc.ui.core.theme.IconInitialization\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil\"),jQuery.sap.require(\"sap.ui.base.EventProvider\"),jQuery.sap.require(\"sas.hc.m.MessageDialog\"),jQuery.sap.require(\"sas.hc.ui.core.util\"),function(){\"use strict\";var e=sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator;sap.ui.base.EventProvider.extend(\"sas.hc.ui.services.comment.petrichor.controller.CommentManagerController\",{metadata:{events:{success:{},fail:{}}},constructor:function(e){if(sap.ui.base.EventProvider.apply(this,arguments),!e||!sas.hc.ui.core.util.lazyInstanceof(e,\"sas/hc/ui/services/comment/petrichor/CommentManager\"))throw new Error(\"Comment Manager should be instance of 'sas.hc.ui.services.comment.petrichor.model.CommentDataModel'\");this._commentMgr=e,this._serviceProxy=null,this._searchString=\"\",this._pageSize,this._initialReplyFetch=!1,this._currentPageFirstItemIndex,this._lastFetchTotalCount,this._commentToBeFocused},rb:sap.ui.getCore().getLibraryResourceBundle(\"sas.hc.ui.services.comment\")}),sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.setServiceProxy=function(e){return e||(sas.log.error(\"ServiceProxy should not be '\"+e+\"'\"),e=null),sas.hc.ui.core.util.lazyInstanceof(e,\"sas/hc/ui/services/comment/petrichor/proxy/AbstractServiceProxy\")||(sas.log.error(\"Property 'serviceProxy' should be instance of 'sas.hc.ui.services.comment.petrichor.proxy.AbstractServiceProxy'\"),e=null),this._serviceProxy=e,this},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.getServiceProxy=function(){return this._serviceProxy},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.fetchComments=function(e,t,r,s,o){if(this._commentMgr&&this._commentMgr.getResourceUri()&&this._serviceProxy){var n={resourceUri:this._commentMgr.getResourceUri(),elementId:this._commentMgr.getElementId(),direction:e,searchString:t,modifiedCommentId:r,operation:s,pageSize:this._pageSize};this._serviceProxy.getComments(n,jQuery.proxy(this._getCommentsResultHandler,this,o),jQuery.proxy(this._getCommentsFaultHandler,this)),this._commentMgr.setBusy(!0)}},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.setPaginatorFilter=function(e){this._serviceProxy.setPaginatorFilter(e)},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._getCommentsResultHandler=function(e,t){var r=new sas.hc.ui.services.comment.petrichor.model.Comment;this._currentPageFirstItemIndex=t.current,this._lastFetchTotalCount=t.count,t.matchedCommentId&&(this._commentToBeFocused=t.matchedCommentId),this._originalComments=t.children,this._lastFetchTotalCount>this._pageSize&&(this._currentPageFirstItemIndex+this._pageSize<this._lastFetchTotalCount&&t.children.splice(0,0,r),0!==this._currentPageFirstItemIndex&&t.children.push(r)),t=this._setCommentReadOnly(t);var s=this._checkFetchReplyForCommentExists(e,t);e&&e.parentId&&\"\"!==e.parentId&&s?(this._commentResult=t,this.fetchReplyComments(e)):(this._commentMgr.getModel().setData(t),this.fireEvent(\"success\"),this._commentMgr.getModel().refresh(!0),t.children.length<=0&&(this._commentMgr._postFetchTask(),this._commentMgr._hasWriteAccess&&this._commentMgr._noWriteAccessMessageStrip.setVisible(!0),this._commentMgr._zeroStateNoComments.setIcon(sas.icons.HC.ZEROSTATESMALLCHATBOT),this._commentMgr._zeroStateNoComments.setText(this._commentMgr.rb.getText(\"CommentManager.noComments.message.txt\")),this._commentMgr._searchField.setVisible(!0)))},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._checkFetchReplyForCommentExists=function(e,t){var r=!1,s=t.children;if(e){for(var o=0;o<s.length;o++)if(s[o].id===e.parentId){r=!0;break}r||sas.hc.m.MessageDialog.error({title:this.rb.getText(\"CommentManager.message.title.txt\"),text:this.rb.getText(\"CommentManager.comment.deleted.error.txt\")})}return r},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._getCommentsFaultHandler=function(e){var t=e.getParameters();403===t.status?(this._commentMgr._hasWriteAccess||this._commentMgr._noWriteAccessMessageStrip.setVisible(!1),this._commentMgr._zeroStateNoComments.setIcon(null),this._commentMgr._zeroStateNoComments.setText(this._commentMgr.rb.getText(\"CommentManager.noReadAccess.message.txt\")),this._commentMgr._searchField.setVisible(!1),this._commentMgr._postFetchTask()):this.fireEvent(\"fail\",t)},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.addComment=function(e){e&&this._commentMgr&&e.resourceUri&&this._serviceProxy&&(this._serviceProxy.addComment(e,jQuery.proxy(this._addCommentsResultHandler,this),jQuery.proxy(this._addCommentsFaultHandler,this)),this._commentMgr.setBusy(!0))},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._addCommentsResultHandler=function(e){this._handleCommentAdded(e)},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._addCommentsFaultHandler=function(e,t,r){\"Comment\"===t?sas.hc.m.MessageDialog.error({text:e.join(\"\\n\"),title:this.rb.getText(\"CommentManager.postComment.message.title.txt\")}):(e=e.join(\"\\n\"),sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil.addFaultMessage({message:e,title:this.rb.getText(\"Attachment.addAttachment.message.title.txt\"),type:\"error\"})),r.parentId&&\"\"!==r.parentId?this.fetchComments(null,null,null,null):this._commentMgr._postFetchTask()},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.updateComment=function(e,t){e&&e.resourceUri&&this._serviceProxy&&(this._initialReplyFetch=!1,this._fetchAfterUpdate=void 0===t,this._serviceProxy.updateComment(e,jQuery.proxy(this._updateCommentResultHandler,this),jQuery.proxy(this._updateCommentFaultHandler,this,e)),this._commentMgr.setBusy(!0))},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._updateCommentResultHandler=function(t){if(this._commentMgr._trackCommentToFocusLater(t.id),this._commentMgr.clearSearchFieldAndCommentEntryForm(),this._fetchAfterUpdate)t.parentId&&\"\"!==t.parentId?this.fetchComments(null,null,null,null,t):this.fetchComments(null,null,t.id,e.UPDATE_OP);else{var r=[];this._commentMgr.searchStr&&r.push(this._commentMgr.searchStr),this.fetchComments(this._commentMgr.scrollDir,r)}},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._updateCommentFaultHandler=function(e,t){var r,s,o,n,i=\"\",m=this;if(t.hasOwnProperty(\"modifiedSinceLast\")&&t.modifiedSinceLast)return s=this.rb.getText(\"CommentManager.edit.modified.error.return.txt\"),o=this.rb.getText(\"CommentManager.edit.modified.error.discardChanges.txt\"),n=this.rb.getText(\"CommentManager.edit.modified.error.message.txt\"),void sas.hc.m.MessageDialog.warning({text:n,title:this.rb.getText(\"CommentManager.postComment.message.title.txt\"),buttonActions:[s,o],buttonPress:function(e){switch(e.getParameter(\"origin\").getText()){case o:m._updateCommentResultHandler(t.comment);break;case s:m._commentMgr._postFetchTask()}}});for(var a in t)if(t.hasOwnProperty(a)){var c=t[a];for(r=0;r<c.length;r++)i+=c[r]+\"\\n\"}t.deleteAttachmentFailure&&t.addAttachmentFailure&&t.updateCommentTextFailure?(t.deleteAttachmentFailure.length>0&&0===t.addAttachmentFailure.length&&0===t.updateCommentTextFailure.length?sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil.addFaultMessage({message:i,title:m.rb.getText(\"Attachment.deleteAttachment.fileNotFound.message.txt\"),type:\"error\"}):0===t.deleteAttachmentFailure.length&&t.addAttachmentFailure.length>0&&0===t.updateCommentTextFailure.length&&sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil.addFaultMessage({message:i,title:m.rb.getText(\"Attachment.addAttachment.message.title.txt\"),type:\"error\"}),this._commentMgr._postFetchTask()):(e.parentId&&\"\"!==e.parentId?sas.hc.m.MessageDialog.error({text:this.rb.getText(\"CommentManager.editReply.deleted.error.message.txt\"),title:this.rb.getText(\"CommentManager.editReply.deleted.error.message.title.txt\")}):sas.hc.m.MessageDialog.error({text:this.rb.getText(\"CommentManager.delete.edit.error.message.txt\"),title:this.rb.getText(\"CommentManager.delete.edit.error.message.title.txt\")}),this.fetchComments(null,null,null,null))},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.openAttachment=function(e){var t=this,r=function(e){window.open(e)},s=function(r){sas.hc.m.MessageDialog.error({text:t.rb.getText(\"Attachment.not.found.error.message.fmt\",e.name),title:t.rb.getText(\"Attachment.message.title.txt\")}),t.fetchComments(null,null,null,null)};this._serviceProxy.getFileContent(e,r,s)},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.deleteComment=function(e){e&&this._serviceProxy&&(this._initialReplyFetch=!1,this._serviceProxy.deleteComment(e,jQuery.proxy(this._deleteCommentResultHandler,this,e),jQuery.proxy(this._deleteCommentFaultHandler,this,e)),this._commentMgr.setBusy(!0))},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._deleteCommentResultHandler=function(t,r){\"\"===t.parentId?(this.fetchComments(null,null,t.id,e.DELETE_OP),this._commentMgr.getCommentEntryForm().setInitialFocus()):this.fetchComments(null,null,null,null,t),this._commentMgr.clearSearchFieldAndCommentEntryForm()},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._deleteCommentFaultHandler=function(e,t){if(404===t.status)\"\"===e.parentId?sas.hc.m.MessageDialog.error({text:this.rb.getText(\"CommentManager.delete.delete.error.message.txt\"),title:this.rb.getText(\"CommentManager.delete.delete.error.message.title.txt\")}):sas.hc.m.MessageDialog.error({text:this.rb.getText(\"CommentManager.deleteReply.deleted.error.message.txt\"),title:this.rb.getText(\"CommentManager.deleteReply.deleted.error.message.title.txt\")});else{var r=JSON.parse(t.responseText);sas.hc.m.MessageDialog.error({text:r.message,title:this.rb.getText(\"CommentManager.delete.delete.error.message.title.txt\")})}this._deleteCommentResultHandler(e)},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._handleCommentAdded=function(e){e.parentId?(this._commentToBeFocused=e,this.fetchComments(null,null,null,null,e)):this.fetchComments(null,null,null,null),this._commentMgr.clearSearchFieldAndCommentEntryForm(),e.parentId||this._commentMgr.getCommentEntryForm().setInitialFocus()},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.SET_CM_BUSY=\"setCMBusy\",sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.COMMENT_ADDED=\"commentAdded\",sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.COMMENT_UPDATED=\"commentUpdated\",sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.COMMENT_DELETED=\"commentDeleted\",sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.getReplies=function(e){if(e.resourceUri||e.elementId||e.parentId){this._serviceProxy.initializeReplyState();var t=\"\"!==this._searchString?[this._searchString]:null;this._initialReplyFetch=!0,this.fetchComments(null,t,null,null,e)}},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.fetchReplyComments=function(e,t){if(this._commentMgr&&this._commentMgr.getResourceUri()&&this._serviceProxy){e=this._getAssociatedCommentObject(e.parentId);var r={resourceUri:e.resourceUri,elementId:e.elementId,searchString:\"\"!==this._searchString?[this._searchString]:null,pageSize:t?e.childCount:this._commentMgr.getMaxReplyDisplay(),parentCommentId:e.id,searchCount:e.searchCount?e.searchCount:0};this._sParentCommentId=t?e.id:e.parentId,this._serviceProxy.getReplyComments(r,jQuery.proxy(this._getReplyResultHandler,this),jQuery.proxy(this._getCommentsFaultHandler,this),t),this._commentMgr.setBusy(!0)}},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._getReplyResultHandler=function(e){var t,r;if(e&&e.children&&e.children.length>0)t=e.children[0].parentId,r=this._getAssociatedCommentObject(t),this._commentToBeFocused=e.children[0],r&&(r.replies=this._setCommentReadOnly(e),r.isReplyExpanded=!0);else if(this._initialReplyFetch){this._initialReplyFetch=!1;var s=jQuery.proxy(function(){sas.hc.m.MessageDialog.error({title:this.rb.getText(\"CommentManager.message.title.txt\"),text:this.rb.getText(\"CommentManager.comment.replies.deleted.error.txt\")})},this),o=jQuery.proxy(function(){sas.hc.m.MessageDialog.error({title:this.rb.getText(\"CommentManager.message.title.txt\"),text:this.rb.getText(\"CommentManager.comment.deleted.error.txt\")})},this);this._serviceProxy.validateComment(this._sParentCommentId,s,o)}this._sParentCommentId=null,this._commentMgr.getModel().setData(this._commentResult),this._commentMgr.getModel().refresh(!0),this.fireEvent(\"success\")},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._getAssociatedCommentObject=function(e){for(var t=this._commentResult.children,r=0;r<t.length;r++)if(t[r].id===e)return t[r];return null},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype._setCommentReadOnly=function(e){if(e){for(var t=0;t<e.children.length;t++)e.children[t].isReadOnly=this._commentMgr.getReadOnly();return e}},sas.hc.ui.services.comment.petrichor.controller.CommentManagerController.prototype.hasUserAccessWithCommentAndFileService=function(e){this._serviceProxy.hasUserAccessWithCommentAndFileService(e)}}();",
	"sas/hc/ui/services/comment/petrichor/model/Attachment.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.model.Attachment\"),jQuery.sap.require(\"sap.ui.base.Object\"),sap.ui.base.Object.extend(\"sas.hc.ui.services.comment.petrichor.model.Attachment\",{constructor:function(){this.id,this.name,this.description,this.docType,this.type,this.data,this.parentUri,this.size}});",
	"sas/hc/ui/services/comment/petrichor/model/Comment.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.model.Comment\"),jQuery.sap.require(\"sap.ui.base.Object\"),sap.ui.base.Object.extend(\"sas.hc.ui.services.comment.petrichor.model.Comment\",{constructor:function(){this.attachments,this.attachmentsToAdd,this.attachmentsToDelete,this.isTextChanged,this.author,this.authorDisplayName,this.createdOn,this.id,this.resourceUri,this.elementId,this.parentId,this.priority,this.subject,this.text,this.modifiedTimeStamp,this.modifiedBy,this.isEditable,this.isDeletable,this.replies,this.childCount,this.isReplyExpanded=!1,this.showReplyTextbox=!1,this.isEditMode=!1,this.searchCount,this.isReadOnly=!1}}),sas.hc.ui.services.comment.petrichor.model.Comment.LOW_PRIORITY=\"low\",sas.hc.ui.services.comment.petrichor.model.Comment.NORMAL_PRIORITY=\"medium\",sas.hc.ui.services.comment.petrichor.model.Comment.HIGH_PRIORITY=\"high\";",
	"sas/hc/ui/services/comment/petrichor/model/CommentsInfo.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.model.CommentsInfo\"),jQuery.sap.require(\"sap.ui.base.Object\"),sap.ui.base.Object.extend(\"sas.hc.ui.services.comment.petrichor.model.CommentsInfo\",{constructor:function(){this.start,this.count,this.limit,this.children,this.selectionIndex,this.matchedCommentId,this.current,this.count}});",
	"sas/hc/ui/services/comment/petrichor/model/TrackComment.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.model.TrackComment\"),jQuery.sap.require(\"sap.ui.base.Object\"),sap.ui.base.Object.extend(\"sas.hc.ui.services.comment.petrichor.model.TrackComment\",{constructor:function(){this._targetCommentId=void 0,this._prevCommentId=void 0,this._nextCommentId=void 0,this._targetTopicId=void 0,this._prevTopicId=void 0,this._nextTopicId=void 0}}),sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.getTargetCommentId=function(){return this._targetCommentId},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.setTargetCommentId=function(e){this._targetCommentId=e},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.clearTargetCommentId=function(){this._targetCommentId=void 0},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.getPrevCommentId=function(){return this._prevCommentId},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.setPrevCommentId=function(e){this._prevCommentId=e},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.clearPrevCommentId=function(){this._prevCommentId=void 0},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.getNextCommentId=function(){return this._nextCommentId},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.setNextCommentId=function(e){this._nextCommentId=e},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.clearNextCommentId=function(){this._nextCommentId=void 0},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.getTargetTopicId=function(){return this._targetTopicId},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.setTargetTopicId=function(e){this._targetTopicId=e},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.clearTargetTopicId=function(){this._targetTopicId=void 0},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.getPrevTopicId=function(){return this._prevTopicId},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.setPrevTopicId=function(e){this._prevTopicId=e},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.clearPrevTopicId=function(){this._prevTopicId=void 0},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.getNextTopicId=function(){return this._nextTopicId},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.setNextTopicId=function(e){this._nextTopicId=e},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.clearNextTopicId=function(){this._nextTopicId=void 0},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.clear=function(){this.clearTargetCommentId(),this.clearPrevCommentId(),this.clearNextCommentId(),this.clearTargetTopicId(),this.clearPrevTopicId(),this.clearNextTopicId()},sas.hc.ui.services.comment.petrichor.model.TrackComment.prototype.isClear=function(){return void 0===this.getTargetCommentId()&&void 0===this.getPrevCommentId()&&void 0===this.getNextCommentId()&&void 0===this.getTargetTopicId()&&void 0===this.getPrevTopicId()&&void 0===this.getNextTopicId()};",
	"sas/hc/ui/services/comment/petrichor/pagination/CommentsPaginator.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator\"),jQuery.sap.require(\"sas.hc.ui.core.Core\"),jQuery.sap.require(\"sap.ui.base.ManagedObject\"),function(){sap.ui.base.ManagedObject.extend(\"sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator\",{metadata:{library:\"\",properties:{resourceUri:{type:\"string\",group:\"\"},elementId:{type:\"string\",group:\"\"},filter:{type:\"string\",defaultValue:\"\",group:\"\"},pageSize:{type:\"int\",defaultValue:10,group:\"\"}},events:{success:{},fail:{}},publicMethods:[\"pull\"]},constructor:function(t,e,i){this.intializeState(),sap.ui.base.ManagedObject.apply(this,t,e,i)},logger:sas.log.getLogger(\"sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator\")});var t=sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator;Object.defineProperties(t,{PAGINATION_FILTERS:{value:Object.defineProperties({},{BY_TEXT:{value:'contains($primary,text, \"$1\")'},GET_COMMENTS:{value:'or(isNull(parentId),eq(parentId,\"\"))'}})},DELETE_OP:{value:\"Delete\"},UPDATE_OP:{value:\"Update\"},MOVE_UP:{value:\"MOVE_UP\"},MOVE_DOWN:{value:\"MOVE_DOWN\"}}),t.prototype.setFilter=function(t){this.getProperty(\"filter\")!==t&&(this.setProperty(\"filter\",t),this.intializeState())},t.prototype._getCommentService=function(){return this._service||(jQuery.sap.require(\"sas.hc.ui.services.petrichor.comments.CommentService\"),this._service=new sas.hc.ui.services.petrichor.comments.CommentService),this._service},t.prototype.intializeState=function(){this._lastCount=0,this._dataBucket=[],this._lastToLastCount=void 0,this._currentPageFirstItemIndex=0,this._start=0},t.prototype.setProperty=function(t,e){-1!==[\"filter\",\"pageSize\",\"resourceUri\"].indexOf(t)&&this.getProperty(t)!==e&&this.intializeState(),sap.ui.base.ManagedObject.prototype.setProperty.apply(this,arguments)},t.prototype._populateFilterExpression=function(t){var e=0;if(t&&t.length===this.getFilter().match(/\\$\\d/gi).length)return this.getFilter().replace(/\\$\\d/gi,function(i){return t[e++]})},t.prototype._grabNextComments=function(t){for(this._nextComments=[];--t>=0&&this._nextComments.length<2;)this._nextComments.push(this._dataBucket[t].id)},t.prototype._grabPreviousComments=function(t){for(this._previousComments=[];++t<this._dataBucket.length&&this._previousComments.length<2;)this._previousComments.push(this._dataBucket[t].id)},t.prototype._storePrevAndNextComments=function(t){var e=this;$.each(this._dataBucket,function(i,s){if(t===s.id)return e._grabPreviousComments(i),e._grabNextComments(i),!1})},t.prototype.pull=function(t,e,i,s){var r=this.getFilter(),a={};return e&&$.isArray(e)&&null!==e[0]&&void 0!==e[0]&&(r=this._populateFilterExpression(e)),this._storePrevAndNextComments(i),this._setPageIndicators(t),a.data={},a.data.start=this._start,a.data.limit=this._limit,r&&(a.data.filter=r),a.data.sortBy=\"creationTimeStamp:descending\",this.getElementId()&&(a.data.filter='and(eq(elementId, \"'+this.getElementId()+'\"),'+a.data.filter+\")\"),e&&0!==e.length?this._getCommentService().getCommentsBySearch(this.getResourceUri(),a).done($.proxy(this._pullSuccess,this,t,e,i,s)).fail($.proxy(this._pullFail,this,t,e,i,s)):this._getCommentService().getComments(this.getResourceUri(),a).done($.proxy(this._pullSuccess,this,t,e,i,s)).fail($.proxy(this._pullFail,this,t,e,i,s))},t.prototype._setPageIndicators=function(e){0===this._lastCount||this._lastCount/this.getPageSize()==0?(this._currentPageFirstItemIndex=0,this._start=0):(e===t.MOVE_UP?this._currentPageFirstItemIndex=this._currentPageFirstItemIndex+this.getPageSize():e===t.MOVE_DOWN&&(this._currentPageFirstItemIndex=this._currentPageFirstItemIndex-this.getPageSize()),this._validateCurrentPageIndicator(),this._start=this._currentPageFirstItemIndex-this.getPageSize(),this._start=this._start>0?this._start:0),0===this._currentPageFirstItemIndex?this._limit=2*this.getPageSize():this._limit=3*this.getPageSize()},t.prototype._validateCurrentPageIndicator=function(){var t;t=this._lastCount%this.getPageSize()==0?(this._lastCount/this.getPageSize()-1)*this.getPageSize():Math.floor(this._lastCount/this.getPageSize())*this.getPageSize(),this._currentPageFirstItemIndex>t&&(this._currentPageFirstItemIndex=t),this._currentPageFirstItemIndex=this._currentPageFirstItemIndex>0?this._currentPageFirstItemIndex:0},t.prototype._adjustCurrentPageIndicator=function(){function t(t){r._currentPageFirstItemIndex>0&&(r._currentPageFirstItemIndex=r._currentPageFirstItemIndex+t)}var e,i,s,r=this;e=this._lastCount-this._lastToLastCount,e<0?this._validateCurrentPageIndicator():e>0&&(i=this._lastToLastCount%this.getPageSize(),0===i?t(Math.ceil(Math.abs(e)/this.getPageSize())*this.getPageSize()):(s=e-(this.getPageSize()-i))>0&&t(Math.ceil(Math.abs(s)/this.getPageSize())*this.getPageSize()))},t.prototype._pullSuccess=function(e,i,s,r,a){var n,o,h,u=[],c=a.items?a.items.slice(0):[],g=-1,l=-1;if(this._dataBucket=c.slice(0),this._lastCount=a.count,0===c.length)return 0===this._currentPageFirstItemIndex?void this._dispatchEvent(\"success\",{items:[],selectionIndex:g}):void this.pull(e,i,s,r);void 0!==this._lastToLastCount&&this._adjustCurrentPageIndicator(),this._lastToLastCount=this._lastCount,s&&this._previousComments&&this._nextComments&&(n=[s,this._previousComments[0],this._nextComments[0],this._previousComments[1],this._nextComments[1]],r&&r===t.DELETE_OP&&n.splice(0,1),$.each(n,function(t,e){if($.each(c,function(t,i){if(i.id===e)return g=t,h=i.id,!1}),g>-1)return!1}),g>-1&&(u=c.slice(0).splice(Math.floor(g/this.getPageSize())*this.getPageSize(),this.getPageSize()))),0===u.length&&(u=0===this._currentPageFirstItemIndex||c.length<this.getPageSize()?c.slice(0).splice(0,this.getPageSize()):c.slice(0).splice(this.getPageSize(),this.getPageSize())),u.length<this.getPageSize()&&this._dataBucket.length>=this.getPageSize()&&(o=this.getPageSize()-u.length,$.each(c,function(t,e){if(u[0].id===e.id)return l=t,!1}),u=c.slice(0).splice(Math.abs(l-o),o).concat(u)),this._dispatchEvent(\"success\",{items:u.reverse(),matchedCommentId:h,selectionIndex:g})},t.prototype._dispatchEvent=function(t,e){\"success\"===t&&(e.count=this._lastCount,e.current=this._currentPageFirstItemIndex),this.fireEvent(t,e)},t.prototype._pullFail=function(t,e,i,s,r){this.logger.debug(\"The getComments pagination request failed for the following : start: \"+this._start+\", limit: \"+this._limit+\"filter: \"+this._populateFilterExpression(arguments[1])),this._dispatchEvent(\"fail\",r)}}();",
	"sas/hc/ui/services/comment/petrichor/proxy/AbstractServiceProxy.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.proxy.AbstractServiceProxy\"),jQuery.sap.require(\"sap.ui.base.EventProvider\"),sap.ui.base.EventProvider.extend(\"sas.hc.ui.services.comment.petrichor.proxy.AbstractServiceProxy\",{metadata:{abstract:!0,publicMethods:[\"getComments\",\"addComment\",\"updateComment\",\"deleteComment\",\"faultHandler\"]}});",
	"sas/hc/ui/services/comment/petrichor/proxy/CommentPetrichorServiceProxy.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy\"),jQuery.sap.require(\"sap.ui.core.Core\"),jQuery.sap.require(\"sas.hc.ui.core.Core\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.proxy.AbstractServiceProxy\"),jQuery.sap.require(\"sas.hc.ui.services.petrichor.comments.CommentService\"),jQuery.sap.require(\"sas.hc.ui.services.petrichor.files.FileService\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.Comment\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.Attachment\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.model.CommentsInfo\"),jQuery.sap.require(\"sas.hc.m.MessageDialog\"),jQuery.sap.require(\"sas.hc.ui.services.RestService\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator\"),jQuery.sap.require(\"sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil\"),function(){\"use strict\";var e=new sas.hc.ui.services.RestService;e.url=\"/identities/users\",e.crossDomain=!1,e.authenticate=!0;var t,i;sas.hc.ui.services.comment.petrichor.proxy.AbstractServiceProxy.extend(\"sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy\",{metadata:{publicMethods:[\"getComments\",\"addComment\",\"updateComment\",\"deleteComment\",\"faultHandler\"],events:{fail:{}}},constructor:function(){sas.hc.ui.services.comment.petrichor.proxy.AbstractServiceProxy.call(this),this.userDisplayNames={},this._retrievedComments,this._commentService=new sas.hc.ui.services.petrichor.comments.CommentService,this._attachmentService,this._paginator=new sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator,this.initializeReplyState(),this._COMMENT_SERVICE=\"comment\",this._ATTACHMENT_SERVICE=\"attachment\"},rb:sap.ui.getCore().getLibraryResourceBundle(\"sas.hc.ui.services.comment\")}),sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._getPetrichorFileService=function(){return this._attachmentService||(this._attachmentService=new sas.hc.ui.services.petrichor.files.FileService),this._attachmentService||sas.hc.m.MessageDialog.error({text:this.rb.getText(\"CommentManager.message.title.txt\"),title:this.rb.getText(\"CommentManager.message.serviceFail.txt\")}),this._attachmentService},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.getComments=function(e,t,i){var r=jQuery.proxy(function(e){this._getAssociatedDataForComments(e.getParameters(),t,s),this._paginator.detachSuccess(r),this._paginator.detachFail(s)},this),s=jQuery.proxy(function(e){i?i(e):this.faultHandler(e),this._paginator.detachSuccess(r),this._paginator.detachFail(s)},this);this._paginator.setProperty(\"resourceUri\",e.resourceUri),this._paginator.setProperty(\"elementId\",e.elementId),e.pageSize&&this._paginator.setProperty(\"pageSize\",e.pageSize),$.isArray(e.searchString)&&null!==e.searchString[0]&&void 0!==e.searchString[0]?this._paginator.setFilter(sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator.PAGINATION_FILTERS.BY_TEXT):this._paginator.setFilter(sas.hc.ui.services.comment.petrichor.pagination.CommentsPaginator.PAGINATION_FILTERS.GET_COMMENTS),this._paginator.pull(e.direction,e.searchString,e.modifiedCommentId,e.operation),this._paginator.attachSuccess(r),this._paginator.attachFail(s)},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.setPaginatorFilter=function(e){this._paginator.setFilter(e)},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._getAssociatedDataForComments=function(t,r,s){var o,a,n,c,m,h=t.items?t.items:[],p=this,u=[],l=[],d=this,y=[],f=function(e){if(e&&e.items){var t,i,r=e.items;for(t=0;r&&t<r.length;t++)i=r[t],p.userDisplayNames[i.id]=i.name}},v=function(e){},C=function(){o.post({url:o.url+\"/files\",data:n,headers:{\"content-type\":\"application/vnd.sas.selection+json\",accept:\"application/vnd.sas.collection+json\"}}).done(g).fail(x).always(function(){r(p._processRetrievedComments(t));var e,i=\"\";if(l.length>0){for(e=0;e<l.length;e++)i+=l[e]+\"\\n\";sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil.addFaultMessage({message:i,title:p.rb.getText(\"CommentManager.message.title.txt\"),type:\"error\"})}})},g=function(e){e&&e.items&&p._populateComments(e.items,h)},x=function(e){d._processFault(e,l,d._ATTACHMENT_SERVICE)};if(h.length>0){o=this._getPetrichorFileService();for(var _=0;_<h.length;_++)a=h[_],u.push(a.id),u.push(\"/comments/comments/\"+a.id),a&&!this.userDisplayNames.hasOwnProperty(a.createdBy)&&-1===y.indexOf(a.createdBy)&&(y.push(a.createdBy),c=!0);n={selection:{version:1,type:\"id\",template:o.url+\"/files?parentUri={id}\",resources:{id:u}}},c?e&&(m={},m.url=e.url+\"?filter=in(id,\"+y.join(\",\")+\")\",e.get(m).done(f).fail(v).always(function(){i.done(function(e){jQuery.each(e.authorizedLinks,function(e,i){\"/files/files\"===JSON.parse(e).uri&&(i?C():r(p._processRetrievedComments(t)))})})})):i.done(function(e){jQuery.each(e.authorizedLinks,function(e,i){\"/files/files\"===JSON.parse(e).uri&&(i?C():r(p._processRetrievedComments(t)))})})}else r(p._processRetrievedComments(t))},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._populateComments=function(e,t){e.length>0&&$.each(e,function(e,i){var r=new sas.hc.ui.services.comment.petrichor.model.Attachment;r.id=i.id,r.name=i.name,r.type=i.contentType,r.docType=i.documentType,r.size=i.size,r.parentUri=i.parentUri,$.each(t,function(e,t){if(t.id===r.parentUri.replace(\"/comments/comments/\",\"\")){t.attachments||(t.attachments=[]);var i=!1;return $.each(t.attachments,function(e,t){t.id===r.id&&(i=!0)}),i||t.attachments.push(r),!1}})})},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._processRetrievedComments=function(e){return this._createCommentInfo(e)},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._createCommentInfo=function(e){var t,i,r,s,o,a=e.items?e.items:[],n=[];for(t=new sas.hc.ui.services.comment.petrichor.model.CommentsInfo,t.selectionIndex=e.selectionIndex,t.matchedCommentId=e.matchedCommentId,t.current=e.current,t.count=e.count,i=0;i<a.length;i++)r=a[i],s=new sas.hc.ui.services.comment.petrichor.model.Comment,this.userDisplayNames&&this.userDisplayNames[r.createdBy]?s.authorDisplayName=this.userDisplayNames[r.createdBy]:s.authorDisplayName=r.createdBy,s.attachments=r.attachments,s.author=r.createdBy,s.createdOn=r.creationTimeStamp,s.id=r.id,s.resourceUri=r.resourceUri,s.elementId=r.elementId,s.parentId=r.parentId,s.priority=r.priority,s.subject=r.subject,s.text=r.text,s.childCount=r.childCount,s.searchCount=r.searchCount,s.modifiedTimeStamp=r.modifiedTimeStamp,s.modifiedBy=r.modifiedBy,o=this._editDeleteCapability(r),s.isEditable=o.isEditable,s.isDeletable=o.isDeletable,n.push(s);return t.children=n,t},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._editDeleteCapability=function(e){var t,i={};if(i.isEditable=!1,i.isDeletable=!1,e.links&&$.isArray(e.links))for(t=0;t<e.links.length;t++)\"PUT\"===e.links[t].method&&(i.isEditable=!0),\"DELETE\"===e.links[t].method&&(i.isDeletable=!0);return i},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.addComment=function(e,t,i){if(e){var r=e.attachments,s=this,o=function(e){s._reset(),t(e)};delete e.attachments,this.faultArray=[],this._commentService.addComment(e,{context:this}).done(function(e){r&&r.length>0?(this._addedComment=e,this._addAttachmentToComment(e,r,o,i)):o(e)}).fail(function(t){this._processFault(t,this.faultArray,this._COMMENT_SERVICE),i(this.faultArray,\"Comment\",e)})}},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.updateComment=function(e,t,i){var r=$.proxy(function(r,s,o){var a={},n=new Date(e.modifiedTimeStamp),c=new Date(r.modifiedTimeStamp);if(n.getTime()===c.getTime())a[\"if-unmodified-since\"]=o.getResponseHeader(\"Last-Modified\"),this._updateCommentImpl(e,a,t,i);else{i({modifiedSinceLast:!0,comment:e})}},this);this.faultArray=[];var s={validateCommentFailure:[]},o=function(e){this._processFault(e,s.validateCommentFailure,this._COMMENT_SERVICE),i(s)};this._commentService.getComment(e.id).done(r).fail(jQuery.proxy(o,this))},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._updateCommentImpl=function(e,t,i,r){var s={addAttachmentFailure:[],deleteAttachmentFailure:[],updateCommentTextFailure:[]},o=new jQuery.Deferred,a=new jQuery.Deferred,n=new jQuery.Deferred,c=function(e,t,i){\"success\"!==e&&(t===o?s.updateCommentTextFailure.push(i):t===a?s.addAttachmentFailure=i:t===n&&(s.deleteAttachmentFailure=i)),t.resolve()},m=function(e,t){return $.proxy(c,this,e,t)};jQuery.when(o,a,n).done(function(){i(e),(s.updateCommentTextFailure.length>0||s.addAttachmentFailure.length>0||s.deleteAttachmentFailure.length>0)&&r(s)}),e.isTextChanged?this._updateCommentText($.extend({},e),t,m(\"success\",o),m(\"fault\",o)):o.resolve(),e.attachmentsToAdd&&e.attachmentsToAdd.length>0?this._addAttachmentToComment(e,e.attachmentsToAdd,m(\"success\",a),m(\"fault\",a)):a.resolve(),e.attachmentsToDelete&&e.attachmentsToDelete.length>0?this._deleteAttachmentFromComment(e.id,e.attachmentsToDelete,m(\"success\",n),m(\"fault\",n)):n.resolve()},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._updateCommentText=function(e,t,i,r){var s=e.id;delete e.attachments,delete e.attachmentsToAdd,delete e.attachmentsToDelete,delete e.isTextChanged,delete e.modifiedTimeStamp,this._commentService.updateComment(s,e,{headers:t}).done(i).fail(r)},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.deleteComment=function(e,t,i){this._commentService.deleteComment(e.id,{context:this}).done(t).fail(i||this.faultHandler)},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._addAttachmentToComment=function(e,i,r,s){if(i){var o,a=0;if((o=this._getPetrichorFileService())&&!1!==t){var n=function(t,o){a++,sas.log.info(a+\" ) \"+t.name+\" has been uploaded\"),a===i.length?(this.faultArray.length>0&&s(this.faultArray,\"attachemnts\",e),r(this._addedComment),this._addedComment=void 0):u()},c=function(t,o){this._processFault(o,this.faultArray,this._ATTACHMENT_SERVICE),a++,a===i.length?(this.faultArray.length>0&&s(this.faultArray,\"attachments\",e),r(this._addedComment),this._addedComment=void 0):u()},m=function(e,i,r,s){if(r){var o;o=this._getPetrichorFileService(),o&&!1!==t&&o.updateFile(i,r,{header:s}).done(jQuery.proxy(n,this,e)).fail(jQuery.proxy(c,this,e))}},h=function(t,i,r,s){var o={};o[\"if-match\"]=s.getResponseHeader(\"ETag\"),o.Accept=\"application/json\",i.parentUri=\"/comments/comments/\"+e.id,i.documentType=t.type,i.name=t.name,jQuery.proxy(m,this,t)(i.id,i,o)},p=function(t,o){a++,this._processFault(o,this.faultArray,this._ATTACHMENT_SERVICE),a===i.length?(this.faultArray.length>0&&s(this.faultArray,\"attachemnts\",e),r(this._addedComment),this._addedComment=void 0):u()},u=jQuery.proxy(function(){var e=i[a],t=new FormData,r=new Blob([e.data],{type:e.type||\"application/octet-stream\"});t.append(\"fileData\",r,e.name);var s={Accept:\"application/json\",\"Content-Disposition\":\"inline; filename*=UTF-8''\"+sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil.encodeRFC5987ValueChars(e.name)};o.addFile({data:t,headers:s,contentType:!1,processData:!1,context:this}).done(jQuery.proxy(h,this,e)).fail(jQuery.proxy(p,this,e))},this),l=function(e){u()},d=function(t){this._processFault(t,this.faultArray,this._ATTACHMENT_SERVICE),this.faultArray.length>0&&s(this.faultArray,\"attachemnts\",e),r(this._addedComment),this._addedComment=void 0};o.validateFileService({}).done(jQuery.proxy(l,this)).fail(jQuery.proxy(d,this))}}},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._addAttachmentContent=function(e,i,r,s){var o,a,n=this;(o=this._getWipAttachmentService())&&!1!==t&&i.length>0&&(a=i.shift(),o.put({\"object-type-id\":sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.OBJECT_TYPE_ID,\"object-id\":e,id:a.id+\"/contents\",context:this,data:a.data,processData:!1}).fail(function(e){var t=e;return function(e){sas.hc.m.MessageDialog.error({text:this.rb.getText(\"Attachment.uploadContent.error.message.fmt\",[t]),title:this.rb.getText(\"Attachment.addAttachment.message.title.txt\")})}}(a.name)).always(function(e,t,i,r){var s=e,o=t,a=i,c=r;return function(){o.length<=0?(i(this._addedComment),this._addedComment=void 0):n._addAttachmentContent(s,o,a,c)}}(e,i,r,s)))},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._deleteAttachmentFromComment=function(e,t,i,r){if(t){var s,o,a,n,c,m=0,h=[];if(s=this._getPetrichorFileService())for(c=this.rb.getText(\"Attachment.deleteAttachment.fileNotFounded.message.txt\")+\"\\n\",a=0;a<t.length;a++)o=t[a],s.deleteFile(o.id,{async:!1}).fail(function(e){if(n=!0,e.responseJSON){var t=e.responseJSON;404===t.httpStatusCode?(0===h.length&&h.push(c),h.push(o.name)):h.push(t.message)}else 404===e.status?(0===h.length&&h.push(c),h.push(o.name)):h.push(e.statusText)}).always(function(e){++m===t.length&&(n&&r(h),i())})}},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._reset=function(){this._paginator.intializeState()},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.getFileContent=function(e,t,i){var r,s=this._getPetrichorFileService(),o=function(i){r=s.url+\"/files/\"+e.id+\"/content\",t(r)},a=function(e){i(e)};s.getFileById(e.id,{headers:{Accept:\"application/json\"}}).done(o).fail(a)},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype._processFault=function(e,t,i){var r;t&&(e.responseJSON?(r=e.responseJSON,t.push(r.message)):404===e.status||503===e.status?i===this._ATTACHMENT_SERVICE?t.push(this.rb.getText(\"Attachment.message.serviceFail.txt\")):t.push(this.rb.getText(\"CommentManager.message.serviceFail.txt\")):t.push(this.rb.getText(\"CommentManager.message.errorMessage.txt\")))},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.faultHandler=function(e){this.fireEvent(\"fail\",e.getParameters())},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.getReplyComments=function(e,t,i,r){var s=jQuery.proxy(function(e){this._getAssociatedDataForComments(e,t,i),this._lastReplyCommentsCount=e.count},this),o={},a='eq(parentId, \"#id\")',n=e.searchString;r?this._limitReply=e.pageSize:(n&&$.isArray(n)&&e.searchCount>0&&null!==n[0]&&void 0!==n[0]&&(a='and(eq(parentId, \"#id\"),contains($primary,text, \"$1\"))',a=a.replace(\"$1\",n[0])),0===this._lastReplyCommentsCount||this._lastReplyCommentsCount/e.pageSize==0?this._limitReply=e.pageSize:this._limitReply+=e.pageSize),a=a.replace(\"#id\",e.parentCommentId),o.data={},o.data.start=0,o.data.limit=this._limitReply,o.data.filter=a,o.data.sortBy=\"creationTimeStamp:descending\",this._commentService.getComments(e.resourceUri,o).done(s).fail(i||this.faultHandler)},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.initializeReplyState=function(){this._limitReply=0,this._lastReplyCommentsCount=0},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.validateComment=function(e,t,i){this._commentService.validateComment(e).done(t).fail(i||this.faultHandler)},sas.hc.ui.services.comment.petrichor.proxy.CommentPetrichorServiceProxy.prototype.hasUserAccessWithCommentAndFileService=function(e){sas.ajax({url:\"/authorization/\"}).always(function(){i=sas.ajax({url:\"/authorization/bulkDecision\",type:\"POST\",data:{links:{'{\"uri\": \"/comments/comments\"}':\"create\",'{\"uri\": \"/files/files\"}':\"create\"}},headers:{Accept:\"application/vnd.sas.authorization.links+json\",ContentType:\"application/json\"}}).done(function(i){jQuery.each(i.authorizedLinks,function(e,i){\"/files/files\"===JSON.parse(e).uri&&(t=i)}),e(i)})})}}();",
	"sas/hc/ui/services/comment/petrichor/util/AttachmentReader.js": "sap.ui.define([\"sap/ui/thirdparty/jquery\",\"sap/ui/base/EventProvider\"],function(t,e){\"use strict\";var a=e.extend(\"sas.hc.ui.services.comment.petrichor.util.AttachmentReader\",{metadata:{events:{complete:{enableEventBubbling:!0}}},constructor:function(t){e.call(this),this._attachments=[],this._attachmentsToAdd=[],this._attachments=t}});return a.M_EVENTS={complete:\"complete\"},a.prototype.readAttachment=function(){var e=!1;this._attachmentLoadCount=0,this._attachmentLoadErrorOccured=!1,this._filesNameOnWhichLoadErrorOccur=[];for(var a=0;a<this._attachments.length;a++){var r=this._attachments[a];if(0!==r.id&&!r.id){var n=new FileReader;n.onload=t.proxy(this._handleFileReaderOnload,this),n.onerror=t.proxy(this._handleFileReaderOnerror,this),n.attachment=r,this._attachmentsToAdd.push(r),n.readAsArrayBuffer(r.fileRef),e=!0}}e||this.fireEvent(\"complete\")},a.prototype._handleFileReaderOnload=function(t){var e={},a=t.target.attachment;delete t.target.attachment,a.data=t.target.result,this._attachmentLoadCount++,this._attachmentLoadCount===this._attachmentsToAdd.length&&(e.attachments=this._attachmentsToAdd,this._attachmentLoadErrorOccured&&(e.errorFileName=this._filesNameOnWhichLoadErrorOccur),this.fireEvent(\"complete\",e)),t.target.onload=void 0,t.target.onerror=void 0},a.prototype._handleFileReaderOnerror=function(t){var e=t.target.attachment.name,a={};this._filesNameOnWhichLoadErrorOccur.push(e),this._attachmentLoadErrorOccured=!0,this._attachmentLoadCount++,this._attachmentLoadCount===this._attachmentsToAdd.length&&(a.attachments=this._attachmentsToAdd,a.errorFileNames=this._filesNameOnWhichLoadErrorOccur,this.fireEvent(\"complete\",a)),t.target.onload=void 0,t.target.onerror=void 0},a});",
	"sas/hc/ui/services/comment/petrichor/util/CommentManagerUtil.js": "jQuery.sap.declare(\"sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil\"),jQuery.sap.require(\"sas.hc.ui.core.theme.IconInitialization\"),jQuery.sap.require(\"sas.hc.m.MessageDialog\"),jQuery.sap.require(\"sas.hc.m.library\"),sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil={hightlightSearchedString:function(e,t){var s=document.getElementById(t);s&&e.length>0&&sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil._highlight(e.toLowerCase(),s)},_dehighlight:function(e){if(e=document.getElementById(e))for(var t=$(e).find(\"ul\")[0],s=0;s<t.childNodes.length;s++){var a=document.getElementById(t.childNodes[s].id+\"-commentTxt\");if(a&&a.hasChildNodes()&&$(a).find(\".sasCMHighlighted\").length>0){var i=$(\"#\"+a.id+\"-inner\").show();a.innerHTML=\"\",a.appendChild(i[0])}}},_highlight:function(e,t){for(var s=$(t).find(\"ul\")[0],a=0;a<s.childNodes.length;a++){var i=document.getElementById(s.childNodes[a].id+\"-commentTxt\");if(i.hasChildNodes()&&0===$(i).find(\".sasCMHighlighted\").length){var n=$(i).text(),r=n.toLowerCase();if(r.indexOf(e)>=0){$(\"#\"+$(i)[0].id+\"-inner\").hide();for(var c;-1!==(c=r.indexOf(e));)i.appendChild(document.createTextNode(n.substr(0,c))),i.appendChild(sas.hc.ui.services.comment.petrichor.util.CommentManagerUtil._createNode(document.createTextNode(n.substr(c,e.length)))),n=n.substr(c+e.length),r=r.substr(c+e.length);i.appendChild(document.createTextNode(n))}}}},_createNode:function(e){var t=document.createElement(\"span\");return t.setAttribute(\"class\",\"sasCMHighlighted\"),t.appendChild(e),t},getFileTypeIcon:function(e){if(!e)return sas.icons.OBJECTTYPES.DOCUMENT_OBJ;switch(e){case\".doc\":case\".docx\":return sas.icons.OBJECTTYPES.DOCUMENTMSWORD_OBJ;case\".xls\":case\".xlsx\":return sas.icons.OBJECTTYPES.DOCUMENTMSEXCEL_OBJ;case\".ppt\":case\".pptx\":return sas.icons.OBJECTTYPES.DOCUMENTMSPOWERPOINT_OBJ;case\".pdf\":return sas.icons.OBJECTTYPES.DOCUMENTPDF_OBJ;default:return sas.icons.HC.FILE}},_attachmentFaultQueue:[],addFaultMessage:function(e){this._attachmentFaultQueue.push(e),1===this._attachmentFaultQueue.length&&this.showNextFaultMessage()},showNextFaultMessage:function(){if(this._attachmentFaultQueue.length>0){var e=this._attachmentFaultQueue[0];e.type?sas.hc.m.MessageDialog[e.type]({text:e.message,title:e.title,buttonActions:[sas.hc.m.MessageDialogAction.Close],buttonPress:jQuery.proxy(this._faultMessageHandler,this)}):sas.hc.m.MessageDialog.error({text:e.message,title:e.title,buttonActions:[sas.hc.m.MessageDialogAction.Close],buttonPress:jQuery.proxy(this._faultMessageHandler,this)})}},_faultMessageHandler:function(e){this._attachmentFaultQueue.shift(),this._attachmentFaultQueue.length>0&&this.showNextFaultMessage()},encodeRFC5987ValueChars:function(e){return encodeURIComponent(e).replace(/['()]/g,escape).replace(/\\*/g,\"%2A\").replace(/%(?:7C|60|5E)/g,unescape)}};",
	"sas/hc/ui/services/comment/manifest.json": "{\"_version\":\"1.9.0\",\"sap.app\":{\"_version\":\"1.2.0\",\"id\":\"sas.hc.ui.services.comment\",\"type\":\"library\",\"applicationVersion\":{\"version\":\"10.1.0-0\"},\"title\":\"The OpenUI5-based library, sas.hc.ui.services.comment.\"},\"sap.ui5\":{\"_version\":\"1.1.0\",\"dependencies\":{\"libs\":{\"sap.ui.core\":{},\"sas.hc.ui.commons\":{},\"sas.hc.m\":{},\"sas.ltjs.commons\":{}}},\"library\":{\"i18n\":\"messagebundle.properties\"}}}"
}, "sas/hc/ui/services/comment/library-preload");